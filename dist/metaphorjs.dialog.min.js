(function(){function u(a){return"function"==typeof a}function r(a){return"string"==typeof a||a===""+a}function V(a){return"object"===typeof a&&5===ka(a)}function la(a){if(null===a||"object"!=typeof a)return!1;a=ka(a);return 2<a||-1==a}function fa(a){return"object"==typeof a&&3===ka(a)&&!a.nodeType&&a.constructor===Object}function ma(a){return!0===a||!1===a}function C(){}function Ka(a,b,c,e,g,h){g=g||"before";return function(){if("instead"==g)return b.apply(c||e,arguments);if("before"==g){var d=b.apply(c||
e,arguments);var f=!1!==d?a.apply(e||c,arguments):null}else f=a.apply(e||c,arguments),d=b.apply(c||e,arguments);return h?d:f}}function Ca(a,b){return b?Da("(?:^|\\s)"+b+"(?!\\S)").test(a.className):!1}function U(a,b){b&&!Ca(a,b)&&(a.className+=" "+b)}function ba(a,b){b&&(a.className=a.className.replace(Da("(?:^|\\s)"+b+"(?!\\S)"),""))}function S(a,b,c){if(a&&a.style){var e=a.style,g;"string"===typeof b?(a={},a[b]=c):a=b;for(g in a)e[g]=a[g]}}function H(a,b){return a.getAttribute?a.getAttribute(b):
null}function na(){return!1}function oa(){return!0}function K(a){return new ia(a)}function ua(a){if(a&&void 0!=!a.length&&a!==""+a){for(var b=[],c=-1,e=a.length>>>0;++c!==e;b[c]=a[c]);return b}return a?[a]:[]}function W(a){if(!a)return!1;var b,c;return"object"!=(c=typeof a)&&"function"!=c?!1:u(b=a.then)?b:!1}function I(a,b,c,e){return setTimeout(function(){a.apply(b,c||[])},e||0)}function Ea(a,b){if(!a||!r(a))return null;try{var c=new DOMParser;var e=c.parseFromString(a,b||"text/xml")}catch(g){e=
void 0}if(!e||e.getElementsByTagName("parsererror").length)throw"Invalid XML: "+a;return e}function X(a){return a.substr(0,1).toUpperCase()+a.substr(1)}function La(a,b,c,e){var g=b+"-"+c,h=function(a){a=K(a);for(var d=a.target;d;){if(va(d,b))return e(a);d=d.parentNode}return null};pa[g]||(pa[g]=[]);pa[g].push({el:a,ls:h,fn:e});L(a,c,h)}function Ma(a,b,c,e){var g,h;if(h=pa[b+"-"+c])for(b=-1,g=h.length;++b<g;)h[b].el===a&&h[b].fn===e&&P(a,c,h[b].ls)}function ca(a){var b={top:0,left:0},c=window.document.documentElement;
if(!Na(a)||a===window)return b;a.getBoundingClientRect&&(b=a.getBoundingClientRect());return{top:b.top+wa()-c.clientTop,left:b.left+xa()-c.clientLeft}}var Q={},Oa=Object.prototype.toString,ka=function(){var a={"[object String]":0,"[object Number]":1,"[object Boolean]":2,"[object Object]":3,"[object Function]":4,"[object Array]":5,"[object RegExp]":9,"[object Date]":10};return function(b){if(!b){if(null===b)return 6;if(void 0===b)return 7}var c=a[Oa.call(b)];return void 0===c?-1:1===c&&isNaN(b)?8:
c}}(),Pa=function(){var a,b=function(b){var c={},g=[];0==arguments.length&&(b=!0);return{addFinder:function(a,d,b){g[b?"unshift":"push"]({fn:a,context:d})},add:function(a,d,f){if(c[a]&&!1===c[a].rewritable)return c[a];c[a]={rewritable:"undefined"!=typeof f?f:b,value:d};return d},get:function(a){if(c[a])return c[a].value;if(g.length){var d;var b=0;for(d=g.length;b<d;b++){var k=g[b].fn.call(g[b].context,a,this);if(void 0!==k)return this.add(a,k,!0)}}},remove:function(a){var d=c[a];d&&!0===d.rewritable&&
delete c[a];return d?d.value:void 0},exists:function(a){return!!c[a]},eachEntry:function(a,d){for(var b in c)a.call(d,c[b].value,b)},destroy:function(){this===a&&(a=null);this.remove=this.exists=this.destroy=this.get=this.add=b=c=null}}};b.global=function(){a||(a=new b(!0));return a};return b}(),ya=function(){var a=function(a,b,h){h=h||new Pa(!1);var d=b?b.length:null;a||(a="undefined"!==typeof global?global:window);var f=function(a){return a&&b&&a.substr(0,d)!==b?b+"."+a:a},k=function(d,c){d=f(d);
if(h.exists(d))return h.get(d);if(!c){c=d.split(".");var k,e=c.length,n=a;for(k=0;k<e;k++){var g=c[k];if(b&&0===k&&g===b)n=a;else{if(void 0===n[g])return;n=n[g]}}n&&h.add(d,n);return n}};this.register=function(d,c){d=f(d);var k=d.split("."),e=k.pop();var n=k.join(".");var g=k.length,l=a;if(h[n])d=[h[n],e,d];else{if(0<g)for(n=0;n<g;n++){var E=k[n];b&&0===n&&E===b?l=a:(void 0===l[E]&&(l[E]={}),l=l[E])}d=[l,e,d]}k=d[0];e=d[1];la(k)&&void 0===k[e]&&(k[e]=c,h.add(d[2],c));return c};this.exists=function(a){return void 0!==
k(a,!0)};this.get=k;this.add=function(a,d){a=f(a);h.add(a,d);return d};this.remove=function(a){a=f(a);h.remove(a)};this.normalize=f;this.makeAlias=function(a,d){a=f(a);d=f(d);a=h.get(a);void 0!==a&&h.add(d,a)};this.destroy=function(){var a;this===c&&(c=null);h.eachEntry(function(a){a&&a.$destroy&&a.$destroy()});h.destroy();h=null;for(a in this)this[a]=null}},b=a.prototype;b=b.register=b.exists=b.get=b.add=b.remove=b.normalize=b.makeAlias=b.destroy=null;var c;a.global=function(){c||(c=new a);return c};
return a}(),Y=Array.prototype.slice,w=function(){return function b(){var c=!1,e=!1,g=Y.call(arguments),h=g.shift(),d,f,k;ma(g[g.length-1])&&(c=g.pop());ma(g[g.length-1])&&(e=c,c=g.pop());for(;g.length;)if((d=g.shift())&&d.hasOwnProperty)for(f in d)if(d.hasOwnProperty(f)&&void 0!==(k=d[f]))if(e)if(h[f]&&fa(h[f])&&fa(k))b(h[f],k,c,e);else{if(!0===c||void 0==h[f])fa(k)?(h[f]={},b(h[f],k,c,!0)):h[f]=k}else if(!0===c||void 0==h[f])h[f]=k;return h}}(),Qa=function(a,b){var c=function(){};c.prototype=a.prototype;
c=new c;a=a.apply(c,b);return la(a)||!1===a?a:c},O=function(){var a=function(){this.$super&&this.$super!==C&&this.$super.apply(this,arguments)},b=function(a,d,b){var $super=a.prototype[d]||("$constructor"===d?a:C)||C;return function(){var a=this.$super;if(this.$destroyed)return this.$super=null;this.$super=$super;var d=b.apply(this,arguments);this.$super=a;return d}},c=function(a,d,f,c){var k,e=f.prototype;for(k in d)if(d.hasOwnProperty(k)){var g=e[k];var q=d[k];a[k]=!u(q)||g&&!u(g)?q:b(f,k,q)}c||
(a.$plugins=null,a.$pluginMap=null,e.$beforeInit?(a.$beforeInit=e.$beforeInit.slice(),a.$afterInit=e.$afterInit.slice(),a.$beforeDestroy=e.$beforeDestroy.slice(),a.$afterDestroy=e.$afterDestroy.slice()):(a.$beforeInit=[],a.$afterInit=[],a.$beforeDestroy=[],a.$afterDestroy=[]))},e=function(b){b||(b=new ya);var d=function(a){return function(){var d=[],f=[],c=arguments,k,e;if(!this)throw"Must instantiate via new: "+a;this.$plugins=[];(k=this.$constructor.apply(this,arguments))&&V(k)&&(c=k);var g=this.$plugins;
var n=this.$pluginMap={};k=-1;for(e=this.$beforeInit.length;++k<e;d.push([this.$beforeInit[k],this]));k=-1;for(e=this.$afterInit.length;++k<e;f.push([this.$afterInit[k],this]));if(g&&g.length)for(k=0,e=g.length;k<e;k++){var l=g[k];if(r(l)){var h=l;l=b.get(l,!0);if(!l)throw h+" not found";}l=new l(this,c);n[l.$class]=l;l.$beforeHostInit&&d.push([l.$beforeHostInit,l]);l.$afterHostInit&&f.push([l.$afterHostInit,l]);g[k]=l}k=-1;for(e=d.length;++k<e;d[k][0].apply(d[k][1],c));this.$init&&this.$init.apply(this,
c);k=-1;for(e=f.length;++k<e;f[k][0].apply(f[k][1],c));}},f=function(){};w(f.prototype,{$class:null,$extends:null,$plugins:null,$pluginMap:null,$mixins:null,$destroyed:!1,$destroying:!1,$constructor:C,$init:C,$beforeInit:[],$afterInit:[],$beforeDestroy:[],$afterDestroy:[],$getClass:function(){return this.$class},$is:function(a){return n(this,a)},$getParentClass:function(){return this.$extends},$intercept:function(a,d,b,f,c){var k=this[a];this[a]=Ka(k||C,d,b||this,this,f,c);return k||C},$implement:function(a){var d=
this.constructor;d&&d.$parent&&c(this,a,d.$parent,!0)},$hasPlugin:function(a){return!!this.$pluginMap[b.normalize(a)]},$getPlugin:function(a){return this.$pluginMap[b.normalize(a)]||null},$bind:function(a){var d=this;return function(){if(!d.$isDestroyed())return a.apply(d,arguments)}},$isDestroyed:function(){return l.$destroying||l.$destroyed},$destroy:function(){var a=this.$beforeDestroy,d=this.$afterDestroy,b=this.$plugins,f;if(!this.$destroying&&!this.$destroyed){this.$destroying=!0;var c=-1;for(f=
a.length;++c<f;a[c].apply(this,arguments));c=0;for(f=b.length;c<f;c++)b[c].$beforeHostDestroy&&b[c].$beforeHostDestroy.call(b[c],arguments);a=this.destroy.apply(this,arguments);c=-1;for(f=d.length;++c<f;d[c].apply(this,arguments));c=0;for(f=b.length;c<f;c++)b[c].$destroy.apply(b[c],arguments);if(!1!==a)for(c in this)this.hasOwnProperty(c)&&(this[c]=null);this.$destroying=!1;this.$destroyed=!0}},destroy:function(){}});f.$self=f;f.$instantiate=function(){var a=arguments;switch(a.length){case 0:return new this;
case 1:return new this(a[0]);case 2:return new this(a[0],a[1]);case 3:return new this(a[0],a[1],a[2]);case 4:return new this(a[0],a[1],a[2],a[3]);default:return Qa(this,a)}};f.$override=function(a){var d=this.$self,b=this.$parent;d&&b&&c(d.prototype,a,b)};f.$extend=function(a,d){return k(a,d,this)};f.$destroy=function(){for(var a in this)this[a]=null};var k=function(k,e,g){k=k||{};var n=k.$class,q=g||k.$extends,l=k.$mixins;g=k.$alias;var h,p;if(q)if(r(q))var x=b.get(q);else x=q,q=x.$class||"";else x=
f,q="";if(q&&!x)throw q+" not found";n&&(n=b.normalize(n));k.$class=n;k.$extends=q;k.$mixins=null;q=Object.create(x.prototype);k.$constructor=k.$constructor||a;c(q,k,x);if(l)for(k=0,h=l.length;k<h;k++){var m=l[k];r(m)&&(m=b.get(m,!0));var v=void 0,F=q;for(v in m)m.hasOwnProperty(v)&&("$beforeInit"===v?F.$beforeInit.push(m[v]):"$afterInit"===v?F.$afterInit.push(m[v]):"$beforeDestroy"===v?F.$beforeDestroy.push(m[v]):"$afterDestroy"===v?F.$afterDestroy.push(m[v]):F[v]||(F[v]=m[v]))}l=d(n);q.constructor=
l;q.$self=l;l.prototype=q;for(p in f)"prototype"!==p&&f.hasOwnProperty(p)&&(l[p]=f[p]);for(p in x)"prototype"!==p&&x.hasOwnProperty(p)&&(l[p]=x[p]);if(e)for(p in e)"prototype"!==p&&e.hasOwnProperty(p)&&(l[p]=e[p]);l.$parent=x;l.$self=l;n&&b.register(n,l);g&&b.register(g,l);return l},n=function(a,d){return(d=r(d)?b.get(d):d)?a instanceof d:!1},l=this;l.factory=function(a){var d=b.get(a),f=Y.call(arguments,1);if(!d)throw a+" not found";return d.$instantiate.apply(d,f)};l.isSubclassOf=function(a,d){var f=
a,c=b.get;d=r(d)?b.normalize(d):d.prototype.$class;for(r(a)&&(f=c(b.normalize(a)));f&&f.prototype;){if(f.prototype.$class===d)return!0;f=f.$parent}return!1};l.isInstanceOf=n;l.define=k;l.destroy=function(){l===g&&(g=null);f.$destroy();f=null;b.destroy();e=b=null};l.BaseClass=f};e.prototype={factory:null,isSubclassOf:null,isInstanceOf:null,define:null,destroy:null};var g;e.global=function(){g||(g=new e(ya.global()));return g};return e}(),Z=new ya(Q,"MetaphorJs");O=new O(Z);var N=O.define,ha=O.factory,
ja=function(){var a=["0","0","0"];return function(){for(var b=a.length,c;b;){b--;c=a[b].charCodeAt(0);if(57==c)return a[b]="A",a.join("");if(90==c)a[b]="0";else return a[b]=String.fromCharCode(c+1),a.join("")}a.unshift("0");return a.join("")}}(),m=Function.prototype.bind?function(a,b){return a.bind(b)}:function(a,b){return function(){return a.apply(b,arguments)}},Da=function(){var a={};return function(b){return a[b]||(a[b]=new RegExp(b))}}(),M=function(){var a={};return function(b,c,e){b=b._mjsid||
(b._mjsid=ja());var g=a[b];return void 0!==e?(g||(g=a[b]={}),g[c]=e):g?g[c]:void 0}}(),ia=function(a){if(a instanceof ia)return a;if(!(this instanceof ia))return new ia(a);for(var b in a)if(!this[b])try{this[b]=a[b]}catch(g){}this.originalEvent=a;this.type=a.type;!this.target&&a.srcElement&&(this.target=a.srcElement);var c=a.button;if(void 0===this.pageX&&null!==a.clientX){var e=this.target?this.target.ownerDocument||window.document:window.document;b=e.documentElement;e=e.body;this.pageX=a.clientX+
(b&&b.scrollLeft||e&&e.scrollLeft||0)-(b&&b.clientLeft||e&&e.clientLeft||0);this.pageY=a.clientY+(b&&b.scrollTop||e&&e.scrollTop||0)-(b&&b.clientTop||e&&e.clientTop||0)}this.which||void 0===c||(this.which=c&1?1:c&2?3:c&4?2:0);this.isDefaultPrevented=a.defaultPrevented||void 0===a.defaultPrevented&&!1===a.returnValue?oa:na;this.timeStamp=a&&a.timeStamp||(new Date).getTime()};w(ia.prototype,{isDefaultPrevented:na,isPropagationStopped:na,isImmediatePropagationStopped:na,preventDefault:function(){var a=
this.originalEvent;this.isDefaultPrevented=oa;a.returnValue=!1;a&&a.preventDefault&&a.preventDefault()},stopPropagation:function(){var a=this.originalEvent;this.isPropagationStopped=oa;a.cancelBubble=!0;a&&a.stopPropagation&&a.stopPropagation()},stopImmediatePropagation:function(){var a=this.originalEvent;this.isImmediatePropagationStopped=oa;a&&a.stopImmediatePropagation&&a.stopImmediatePropagation();this.stopPropagation()}},!0,!1);var Fa=function(a){function b(){e=null}var c,e;a=function(a){return function(g){var d=
K(g||window.event),f=Y.call(arguments,1),k=0,n=0,l=0,h=0;d.type="mousewheel";"detail"in d&&(n=-1*d.detail);"wheelDelta"in d&&(n=d.wheelDelta);"wheelDeltaY"in d&&(n=d.wheelDeltaY);"wheelDeltaX"in d&&(k=-1*d.wheelDeltaX);"axis"in d&&d.axis===d.HORIZONTAL_AXIS&&(k=-1*n,n=0);var q=0===n?k:n;"deltaY"in d&&(q=n=-1*d.deltaY);"deltaX"in d&&(k=d.deltaX,0===n&&(q=-1*k));if(0!==n||0!==k){var x=Math.max(Math.abs(n),Math.abs(k));if(!e||x<e)e=x,"mousewheel"===d.type&&0===x%120&&(e/=40);"mousewheel"===d.type&&0===
x%120&&(q/=40,k/=40,n/=40);q=Math[1<=q?"floor":"ceil"](q/e);k=Math[1<=k?"floor":"ceil"](k/e);n=Math[1<=n?"floor":"ceil"](n/e);this.getBoundingClientRect&&(x=this.getBoundingClientRect(),l=d.clientX-x.left,h=d.clientY-x.top);d.deltaX=k;d.deltaY=n;d.deltaFactor=e;d.offsetX=l;d.offsetY=h;d.deltaMode=0;f.unshift(d,q,k,n);c&&clearTimeout(c);c=setTimeout(b,200);return a.apply(this,f)}}};a.events=function(){var a=window.document;return"onwheel"in a||9<=a.documentMode?["wheel"]:["mousewheel","DomMouseScroll",
"MozMousePixelScroll"]};return a}(),L=function(){var a=null,b=null;return function(c,e,g){null===a&&(c.addEventListener?(a="addEventListener",b=""):(a="attachEvent",b="on"));if("mousewheel"==e){g=Fa(g);e=Fa.events();var h;var d=0;for(h=e.length;d<h;d++)c[a](b+e[d],g,!1)}else c[a](b+e,g,!1);return g}}(),P=function(){var a=null,b=null;return function(c,e,g){null===a&&(c.removeEventListener?(a="removeEventListener",b=""):(a="detachEvent",b="on"));c[a](b+e,g)}}(),J=function(){var a=/^[\w[:#.][\w\]*^|=!]*$/,
b=/=([^\]]+)/,c=/ *, */,e=/(\([^)]*)\+/,g=/(\[[^\]]+)~/,h=/(~|>|\+)/,d=/ +/,f=/([^[:.#]+)?(?:#([^[:.#]+))?(?:\.([^[:.]+))?(?:\[([^!&^*|$[:=]+)([!$^*|&]?=)?([^:\]]+)?\])?(?::([^(]+)(?:\(([^)]+)\))?)?/,k=/(?:(-?\d*)n)?(?:(%|-)(\d*))?/,n=/\D/,l=/[^(]*\(([^)]*)\)/,p=/\(.*/,q=/\[([^!~^*|$ [:=]+)([$^*|]?=)?([^ :\]]+)?\]/,x=window.document,T=!!x.getElementsByClassName,qa=!!x.querySelectorAll,E={"first-child":function(a){return a.parentNode.getElementsByTagName("*")[0]!==a},"last-child":function(a){for(;(a=
a.nextSibling)&&1!==a.nodeType;);return!!a},root:function(a){return"html"!==a.nodeName.toLowerCase()},"nth-child":function(a,d){var b=a.nodeIndex||0,f=d[3]=d[3]?("%"===d[2]?-1:1)*d[3]:0;d=d[1];if(b)return!((b+f)%d);var c=a.parentNode.firstChild;b++;do if(1===c.nodeType&&(c.nodeIndex=++b)&&a===c&&(b+f)%d)return 0;while(c=c.nextSibling);return 1},"nth-last-child":function(a,d){var b=a.nodeIndexLast||0,f=d[3]?("%"===d[2]?-1:1)*d[3]:0;d=d[1];if(b)return!((b+f)%d);var c=a.parentNode.lastChild;b++;do if(1===
c.nodeType&&(c.nodeLastIndex=b++)&&a===c&&(b+f)%d)return 0;while(c=c.previousSibling);return 1},empty:function(a){return!!a.firstChild},parent:function(a){return!a.firstChild},"only-child":function(a){return 1!==a.parentNode.getElementsByTagName("*").length},checked:function(a){return!a.checked},lang:function(a,d){return a.lang!==d&&x.documentElement.lang!==d},enabled:function(a){return a.disabled||"hidden"===a.type},disabled:function(a){return!a.disabled},selected:function(a){return!a.selected}},
m={},t=function(a){return m[a]||(m[a]=new RegExp("(^| +)"+a+"($| +)"))},D={"":function(a,d){return null!==H(a,d)},"=":function(a,d,b){var f;return(f=H(a,d))&&f===b},"&=":function(a,d,b){var f;return(f=H(a,d))&&t(b).test(f)},"^=":function(a,d,b){var f;return(f=H(a,d)+"")&&!f.indexOf(b)},"$=":function(a,d,b){var f;return(f=H(a,d)+"")&&f.indexOf(b)===f.length-b.length},"*=":function(a,d,b){var f;return(f=H(a,d)+"")&&-1!==f.indexOf(b)},"|=":function(a,d,b){var f;return(f=H(a,d)+"")&&(f===b||!!f.indexOf(b+
"-"))},"!=":function(a,d,b){var f;return!(f=H(a,d))||!t(b).test(f)}},r=function(v,m){m=m||x;var t=[],r=null,u,z,A;if(qa&&m.querySelectorAll)try{t=ua(m.querySelectorAll(v.replace(b,'="$1"')))}catch(Xa){r=!0}if(!qa||r)if(a.test(v))switch(r=0,v.charAt(0)){case "#":r=v.slice(1);t=x.getElementById(r);t.id!==r&&(t=x.all[r]);t=t?[t]:[];break;case ".":v=v.slice(1);if(T)t=ua((t=m.getElementsByClassName(v)).length?t:[]);else{v=" "+v+" ";var F=m.getElementsByTagName("*");for(u=0;m=F[u++];)-1!==(" "+m.className+
" ").indexOf(v)&&(t[r++]=m);t=r?t:[]}break;case ":":F=m.getElementsByTagName("*");u=0;var R=v.replace(l,"$1");for(z=v.replace(p,"");m=F[u++];)E[z]&&!E[z](m,R)&&(t[r++]=m);t=r?t:[];break;case "[":F=m.getElementsByTagName("*");u=0;m=q.exec(v);v=m[1];var w=m[2]||"";for(A=m[3];m=F[u++];)D[w]&&(D[w](m,v,A)||"class"===v&&D[w](m,"className",A))&&(t[r++]=m);t=r?t:[];break;default:t=ua((t=m.getElementsByTagName(v)).length?t:[])}else{for(var H=v.split(c),J=H.length-1,L=!!J,M,O,B,N,C,G,I,K,S,y,P,Q;r=H[J--];){O=
(M=r.replace(e,"$1%").replace(g,"$1&").replace(h," $1 ").split(d)).length;u=0;N=" ";for(F=m instanceof DocumentFragment?m.children:[m];B=M[u++];)if(" "!==B&&">"!==B&&"~"!==B&&"+"!==B&&F){B=B.match(f);C=B[1]||"*";G=B[2];I=B[3]?" "+B[3]+" ":"";v=B[4];w=B[5]||"";z=B[7];R="nth-child"===z||"nth-last-child"===z?k.exec("even"===B[8]&&"2n"||"odd"===B[8]&&"2n%1"||!n.test(B[8])&&"0n%"+B[8]||B[8]):B[8];K=[];r=S=0;for(P=u===O;y=F[S++];)switch(N){case " ":if(y.getElementsByTagName)for(Q=y.getElementsByTagName(C),
y=0;A=Q[y++];)G&&A.id!==G||I&&-1==(" "+A.className+" ").indexOf(I)||!(!v||D[w]&&(D[w](A,v,B[6])||"class"===v&&D[w](A,"className",B[6])))||A.yeasss||(E[z]?E[z](A,R):z)||(P&&(A.yeasss=1),K[r++]=A);break;case "~":for(C=C.toLowerCase();(y=y.nextSibling)&&!y.yeasss;)1!==y.nodeType||"*"!==C&&y.nodeName.toLowerCase()!==C||G&&y.id!==G||I&&-1===(" "+y.className+" ").indexOf(I)||!(!v||D[w]&&(D[w](A,v,B[6])||"class"===v&&D[w](A,"className",B[6])))||y.yeasss||(E[z]?E[z](y,R):z)||(P&&(y.yeasss=1),K[r++]=y);break;
case "+":for(;(y=y.nextSibling)&&1!==y.nodeType;);!y||y.nodeName.toLowerCase()!==C.toLowerCase()&&"*"!==C||G&&y.id!==G||I&&-1===(" "+A.className+" ").indexOf(I)||!(!v||D[w]&&(D[w](A,v,B[6])||"class"===v&&D[w](A,"className",B[6])))||y.yeasss||(E[z]?E[z](y,R):z)||(P&&(y.yeasss=1),K[r++]=y);break;case ">":if(y.getElementsByTagName)for(Q=y.getElementsByTagName(C),u=0;A=Q[u++];)A.parentNode!==y||G&&A.id!==G||I&&-1==(" "+A.className+" ").indexOf(I)||!(!v||D[w]&&(D[w](A,v,B[6])||"class"===v&&D[w](A,"className",
B[6])))||A.yeasss||(E[z]?E[z](A,R):z)||(P&&(A.yeasss=1),K[r++]=A)}F=K}else N=B;if(L){if(!F.concat){K=[];for(y=0;A=F[y];)K[y++]=A;F=K}t=F.concat(1===t.length?t[0]:t)}else t=F}for(r=t.length;r--;)t[r].yeasss=t[r].nodeIndex=t[r].nodeIndexLast=null}return t};r.is=function(a,d){d=r(d,a.parentNode);var b;var f=-1;for(b=d.length;++f<b;)if(d[f]===a)return!0;return!1};return r}(),va=J.is,ra=function(){var a=["Moz","Webkit","ms","O","Khtml"],b="animationDelay",c="animationDuration",e="transitionDelay",g="transitionDuration",
h="transform",d=null,f=null,k=!1;return function(){if(!k){var n=window.document.createElement("div"),l=!1,p;if(void 0!==n.style.animationName)l=!0;else{var q=0;for(p=a.length;q<p;q++){var x=a[q];if(void 0!==n.style[x+"AnimationName"]){l=!0;b=x+"AnimationDelay";c=x+"AnimationDuration";e=x+"TransitionDelay";g=x+"TransitionDuration";h=x+"Transform";break}}}l&&("ontransitionend"in window?d="transitionend":"onwebkittransitionend"in window&&(d="webkitTransitionEnd"));f=l?{animationDelay:b,animationDuration:c,
transitionDelay:e,transitionDuration:g,transform:h,transitionend:d}:{};k=!0}return f}}(),Ga=function(){var a=function(a){if(!a)return 0;var d=parseFloat(a);-1===a.indexOf("ms")&&(d*=1E3);return d},b=function(d,b,c){var f,k=b.length;for(f=0;f<k;f++){var e=a(b[f])+a(c[f]);d=Math.max(e,d)}return d},c=!1,e=null,g=null,h=null,d=null;return function(a){!1===c&&(e=(c=ra())?c.animationDuration:null,g=c?c.animationDelay:null,h=c?c.transitionDuration:null,d=c?c.transitionDelay:null);if(!c)return 0;var f=window.getComputedStyle?
window.getComputedStyle(a,null):a.style;a=0;var n=(f[e]||"").split(","),l=(f[g]||"").split(","),p=(f[h]||"").split(",");f=(f[d]||"").split(",");a=Math.max(a,b(a,n,l));return a=Math.max(a,b(a,p,f))}}(),za=function(a){var b=M(a,"mjsAnimationQueue");if(V(b)&&b.length){if(b=b[0]){if(b.stages){var c=b.position;var e=b.stages;ba(a,e[c]);ba(a,e[c]+"-active")}b.deferred&&b.deferred.reject(b.el)}}else u(b)?b(a):"stop"===b&&$(a).stop(!0,!0);M(a,"mjsAnimationQueue",null)},aa=function(){var a=[],b=function(b){var c;
var g=0;for(c=a.length;g<c;g++)if(!1===a[g][0].call(a[g][1],b))return;g=(b?b.stack:null)||Error().stack;if("undefined"!=typeof console&&console.error)b&&console.error(b),g&&console.error(g);else throw b;};b.on=function(c,e){b.un(c,e);a.push([c,e])};b.un=function(b,e){var c;var h=0;for(c=a.length;h<c;h++)if(a[h][0]===b&&a[h][1]===e){a.splice(h,1);break}};return b}(),da=function(){var a=[],b=!1,c="undefined"!==typeof process?process.nextTick:function(a){setTimeout(a,0)},e=function(){b=!0;var d=a.shift();
c(function(){d[0].apply(d[1],d[2]);a.length?e():b=!1},0)},g=function(d,c,g){g=g||[];a.push([d,c,g]);b||e()},h=function(a,d){return function(b){try{d.resolve(a(b))}catch(l){d.reject(l)}}},d=function(a,b){if(a instanceof d)return a;if(!(this instanceof d))return new d(a,b);var f;this._fulfills=[];this._rejects=[];this._dones=[];this._fails=[];if(0<arguments.length)if(f=W(a))a instanceof d?a.then(m(this.resolve,this),m(this.reject,this)):(new d(f,a)).then(m(this.resolve,this),m(this.reject,this));else if(u(a))try{a.call(b,
m(this.resolve,this),m(this.reject,this))}catch(l){this.reject(l)}else this.resolve(a)};w(d.prototype,{_state:0,_fulfills:null,_rejects:null,_dones:null,_fails:null,_wait:0,_value:null,_reason:null,_triggered:!1,isPending:function(){return 0===this._state},isFulfilled:function(){return 1===this._state},isResolved:function(){return 1===this._state},isRejected:function(){return 2===this._state},hasListeners:function(){var a=[this._fulfills,this._rejects,this._dones,this._fails],d;var b=0;for(d=a.length;b<
d;b++)if(a[b]&&a[b].length)return!0;return!1},_cleanup:function(){this._fails=this._dones=this._rejects=this._fulfills=null},_processValue:function(a,b){var f;if(0===this._state)if(a===this)this._doReject(new TypeError("cannot resolve promise with itself"));else{try{if(f=W(a)){a instanceof d?a.then(m(this._processResolveValue,this),m(this._processRejectReason,this)):(new d(f,a)).then(m(this._processResolveValue,this),m(this._processRejectReason,this));return}}catch(l){0===this._state&&this._doReject(l);
return}b.call(this,a)}},_callResolveHandlers:function(){this._done();for(var a=this._fulfills,d;d=a.shift();)g(d[0],d[1],[this._value]);this._cleanup()},_doResolve:function(a){this._value=a;this._state=1;0===this._wait&&this._callResolveHandlers()},_processResolveValue:function(a){this._processValue(a,this._doResolve)},resolve:function(a){if(this._triggered)return this;this._triggered=!0;this._processResolveValue(a);return this},_callRejectHandlers:function(){this._fail();for(var a=this._rejects,
d;d=a.shift();)g(d[0],d[1],[this._reason]);this._cleanup()},_doReject:function(a){this._state=2;this._reason=a;0===this._wait&&this._callRejectHandlers()},_processRejectReason:function(a){this._processValue(a,this._doReject)},reject:function(a){if(this._triggered)return this;this._triggered=!0;this._processRejectReason(a);return this},then:function(a,b,c){var f=new d,k=this._state;c&&(a&&(a=m(a,c)),b&&(b=m(b,c)));0===k||0!==this._wait?(a&&u(a)?this._fulfills.push([h(a,f),null]):this._fulfills.push([f.resolve,
f]),b&&u(b)?this._rejects.push([h(b,f),null]):this._rejects.push([f.reject,f])):1===k?a&&u(a)?g(h(a,f),null,[this._value]):f.resolve(this._value):2===k&&(b&&u(b)?g(h(b,f),null,[this._reason]):f.reject(this._reason));return f},"catch":function(a){return this.then(null,a)},_done:function(){for(var a=this._dones,d;d=a.shift();)try{d[0].call(d[1]||null,this._value)}catch(n){aa(n)}},done:function(a,d){var b=this._state;if(1===b&&0===this._wait)try{a.call(d||null,this._value)}catch(l){aa(l)}else 0===b&&
this._dones.push([a,d]);return this},_fail:function(){for(var a=this._fails,d;d=a.shift();)try{d[0].call(d[1]||null,this._reason)}catch(n){aa(n)}},fail:function(a,d){var b=this._state;if(2===b&&0===this._wait)try{a.call(d||null,this._reason)}catch(l){aa(l)}else 0===b&&this._fails.push([a,d]);return this},always:function(a,d){this.done(a,d);this.fail(a,d);return this},promise:function(){return{then:m(this.then,this),done:m(this.done,this),fail:m(this.fail,this),always:m(this.always,this)}},after:function(a){var d=
this;if(W(a)){d._wait++;var b=function(){d._wait--;0===d._wait&&0!==d._state&&(1===d._state?d._callResolveHandlers():d._callRejectHandlers())};u(a.done)?a.done(b):a.then(b)}return d}},!0,!1);d.fcall=function(a,b,c){return d.resolve(a.apply(b,c||[]))};d.resolve=function(a){var b=new d;b.resolve(a);return b};d.reject=function(a){var b=new d;b.reject(a);return b};d.all=function(a){if(!a.length)return d.resolve(null);var b=new d,c=a.length,f=Array(c),e=c,g,h,T=function(a,d){f[d]=a;e--;0===e&&b.resolve(f)};
for(g=0;g<c;g++)(function(c){h=a[g];h instanceof d?h.done(function(a){T(a,c)}).fail(b.reject,b):W(h)||u(h)?(new d(h)).done(function(a){T(a,c)}).fail(b.reject,b):T(h,c)})(g);return b};d.when=function(){return d.all(arguments)};d.allResolved=function(a){if(!a.length)return d.resolve(null);var b=new d,c=a.length,f=[],e=c,g,h=function(a){f.push(a);T()},T=function(){e--;0===e&&b.resolve(f)};for(g=0;g<c;g++){var m=a[g];m instanceof d?m.done(h).fail(T):W(m)||u(m)?(new d(m)).done(h).fail(T):h(m)}return b};
d.race=function(a){if(!a.length)return d.resolve(null);var b=new d,c=a.length,f;for(f=0;f<c;f++){var e=a[f];e instanceof d?e.done(b.resolve,b).fail(b.reject,b):W(e)||u(e)?(new d(e)).done(b.resolve,b).fail(b.reject,b):b.resolve(e);if(!b.isPending())break}return b};d.waterfall=function(a){if(!a.length)return d.resolve(null);var b=a.shift();b=u(b)?d.fcall(b):d.resolve(c);for(var c;c=a.shift();)W(c)?b=b.then(function(a){return function(){return a}}(c)):u(c)?b=b.then(c):b.resolve(c);return b};d.forEach=
function(a,b,c,e){var f=a.slice(),k=new d,g=[],h=0,l=function(){if(f.length){var a=f.shift(),q=h;h++;d.fcall(b,c,[a,q]).done(function(a){g.push(a);l()}).fail(function(a){e?k.reject(a):(g.push(null),l())})}else k.resolve(g)};l();return k};d.counter=function(a){var b=new d;b.countdown=function(){a--;0===a&&b.resolve()};return b};return d}(),G=function(){if("undefined"!==typeof window){var a=window;var b=a.requestAnimationFrame||a.webkitRequestAnimationFrame||a.mozRequestAnimationFrame;var c=a.cancelAnimationFrame||
a.webkitCancelAnimationFrame||a.mozCancelAnimationFrame||a.webkitCancelRequestAnimationFrame;if(b)return function(a,g,h){var d=b(g||h?function(){a.apply(g,h||[])}:a);return function(){c(d)}}}return function(a,b,c){var d=I(a,b,c,0);return function(){clearTimeout(d)}}}(),Ha=function(){var a={show:["mjs-show"],hide:["mjs-hide"],enter:["mjs-enter"],leave:["mjs-leave"],move:["mjs-move"]},b=0,c=!1,e=!1,g=function(a,d,b){var c=function(){(new Date).getTime()-d>=b?a():G(c)};G(c)},h=function(){!1===c&&(c=
ra(),e=!!c);return e},d=function z(a,b,c,f,e,h,m,E){var q=function(){var d=M(a,"mjsAnimationQueue");return d&&d.length&&d[0].id==m?!1:(e.reject(a),!0)},l=function(){if(!q()){var f=c;c++;if(c===b.length){e.resolve(a);M(a,"mjsAnimationQueue").shift();var g=M(a,"mjsAnimationQueue");g.length?(g=g[0],d(g.el,g.stages,0,g.start,g.deferred,!1,g.id,g.step)):M(a,"mjsAnimationQueue",null)}else M(a,"mjsAnimationQueue")[0].position=c,z(a,b,c,null,e,!1,m,E);ba(a,b[f]);ba(a,b[f]+"-active")}},n=function(){q()||(U(a,
b[c]+"-active"),da.resolve(E&&E(a,c,"active")).done(function(){if(!q()){var d=Ga(a);d?g(l,(new Date).getTime(),d):G(l)}}))},x=function(){q()||(U(a,b[c]),da.waterfall([E&&E(a,c,"start"),function(){return f?f(a):null}]).done(function(){!q()&&G(n)}))};h?G(x):x()},f=function(c,f,e,g){var q=new da,l=M(c,"mjsAnimationQueue")||[],n=++b;if(f){if(r(f))var p=a[f];else if(u(f))var m=f;else if(V(f))if(r(f[0]))p=f;else{var t=f[0];var D=f[1]}if(fa(f)){p=f.stages;m=f.fn;t=f.before;D=f.after;var R=f.options?w({},
f.options):{};var v=f.context||null;var F=f.duration||null;e=e||R.start}if(h()&&p)return l.push({el:c,stages:p,start:e,step:g,deferred:q,position:0,id:n}),M(c,"mjsAnimationQueue",l),1===l.length&&d(c,p,0,e,q,!0,n,g),q;R=R||{};e&&(R.start=function(){e(c)});R.complete=function(){q.resolve(c)};F&&(R.duration=F);if(m&&u(m))return t&&w(c.style,t,!0,!1),e&&e(c),M(c,"mjsAnimationQueue",m.call(v,c,function(){q.resolve(c)})),q;if(window.jQuery){f=$(c);t&&f.css(t);M(c,"mjsAnimationQueue","stop");if(m&&r(m))return f[m](R),
q;if(D)return f.animate(D,R),q}}e?(m=e(c),W(m)?m.done(function(){q.resolve(c)}):q.resolve(c)):q.resolve(c);return q};f.addAnimationType=function(d,b){a[d]=b};f.stop=za;f.getPrefixes=ra;f.getDuration=Ga;f.cssAnimationSupported=h;return f}(),Ia=function(){return String.prototype.trim?function(a){return r(a)?a.trim():a}:function(a){return r(a)?a.replace(/^\s\s*/,"").replace(/\s\s*$/,""):a}}(),Ra=function(){return"undefined"!=typeof JSON?function(a){return JSON.parse(a)}:function(a){return(new Function("return "+
a))()}}(),Aa=function(a,b){this.name=a;this.listeners=[];this.map={};this.hash=ja();this.uni="$$"+a+"_"+this.hash;this.suspended=!1;this.lid=0;"object"===typeof b&&null!==b?w(this,b,!0,!1):this.returnResult=b};w(Aa.prototype,{name:null,listeners:null,map:null,hash:null,uni:null,suspended:!1,lid:null,returnResult:null,autoTrigger:null,lastTrigger:null,triggerFilter:null,filterContext:null,expectPromises:!1,resolvePromises:!1,getName:function(){return this.name},destroy:function(){for(var a in this)this[a]=
null},on:function(a,b,c){if(!a)return null;b=b||null;c=c||{};var e=this.uni,g=a||b;if(g[e]&&!c.allowDupes)return null;var h=++this.lid,d=c.first||!1;g[e]=h;a={fn:a,context:b,uniContext:g,id:h,async:!1,called:0,limit:0,start:1,count:0,append:null,prepend:null};w(a,c,!0,!1);!0===a.async&&(a.async=1);d?this.listeners.unshift(a):this.listeners.push(a);this.map[h]=a;if(this.autoTrigger&&this.lastTrigger&&!this.suspended){var f=this.triggerFilter;this.triggerFilter=function(a){return a.id===h?f?!1!==f(a):
!0:!1};this.trigger.apply(this,this.lastTrigger);this.triggerFilter=f}return h},once:function(a,b,c){c=c||{};c.limit=1;return this.on(a,b,c)},un:function(a,b){var c=-1,e=this.uni,g=this.listeners;a=a==parseInt(a)?parseInt(a):(b||a)[e];if(!a)return!1;b=0;for(var h=g.length;b<h;b++)if(g[b].id===a){c=b;delete g[b].uniContext[e];break}if(-1===c)return!1;g.splice(c,1);delete this.map[a];return!0},hasListener:function(a,b){var c=this.listeners;if(a){b=b||a;a=u(a)?b[this.uni]:parseInt(a);if(!a)return!1;
b=0;for(var e=c.length;b<e;b++)if(c[b].id===a)return!0;return!1}return 0<c.length},removeAllListeners:function(){var a=this.listeners,b=this.uni,c;var e=0;for(c=a.length;e<c;e++)delete a[e].uniContext[b];this.listeners=[];this.map={}},suspend:function(){this.suspended=!0},resume:function(){this.suspended=!1},_prepareArgs:function(a,b){if(a.append||a.prepend)b=Y.call(b),a.prepend&&(b=a.prepend.concat(b)),a.append&&(b=b.concat(a.append));return b},trigger:function(){var a=this,b=a.listeners,c=a.returnResult,
e=a.triggerFilter,g=a.filterContext,h=a.expectPromises,d=[],f;if(a.suspended)return null;a.autoTrigger&&(a.lastTrigger=Y.call(arguments));if(0===b.length)return null;var k="all"===c||"concat"===c?[]:"merge"===c?{}:null,n,l;for(n="first"===c?[b[0]]:Y.call(b);l=n.shift();)if(!(!l||!a.map[l.id]||(b=a._prepareArgs(l,arguments),e&&!1===e.call(g,l,b,a))||l.filter&&!1===l.filter.apply(l.filterContext||l.context,b)||(l.count++,l.count<l.start))){if(l.async&&!h){var p=null;I(l.fn,l.context,b,l.async)}else h?
(p=function(d,b,c){return function(f){"pipe"===b&&(c[0]=f,c=a._prepareArgs(d,c));return d.fn.apply(d.context,c)}}(l,c,Y.call(arguments)),p=f?f.then(p):l.fn.apply(l.context,b),p.catch(function(a){console.log(a)})):p=l.fn.apply(l.context,b);l.called++;l.called===l.limit&&a.un(l.id);if("first"===c)return p;if(h)d.push(p),"pipe"===c&&p&&(f=p);else if(null!==c)if("all"===c)k.push(p);else if("concat"===c&&p)k=k.concat(p);else if("merge"===c)w(k,p,!0,!1);else{if("nonempty"===c&&p)return p;if("pipe"===c)k=
p,arguments[0]=p;else if("last"===c)k=p;else{if(!1===c&&!1===p)return!1;if(!0===c&&!0===p)return!0}}}return h?(e=da.all(d),a.resolvePromises&&null!==c&&"all"!==c&&(e=e.then(function(a){var d,b=a.length;for(d=0;d<b;d++){var f=a[d];if("concat"===c&&f)k=k.concat(f);else if("merge"===c)w(k,f,!0,!1);else{if("nonempty"===c&&f)return f;if(!1===c&&!1===f)return!1;if(!0===c&&!0===f)return!0}}return k})),e):k}},!0,!1);var Ba=function(){this.events={}};w(Ba.prototype,{createEvent:function(a,b){a=a.toLowerCase();
var c=this.events;c[a]||(c[a]=new Aa(a,b));return c[a]},getEvent:function(a){a=a.toLowerCase();return this.events[a]},on:function(a,b,c,e){a=a.toLowerCase();var g=this.events;g[a]||(g[a]=new Aa(a));return g[a].on(b,c,e)},once:function(a,b,c,e){e=e||{};e.limit=1;return this.on(a,b,c,e)},un:function(a,b,c){a=a.toLowerCase();var e=this.events;e[a]&&e[a].un(b,c)},relayEvent:function(a,b){a.on(b,this.trigger,this,{prepend:"*"===b?null:[b]})},unrelayEvent:function(a,b){a.un(b,this.trigger,this)},hasListener:function(a,
b,c){var e=this.events;if(a)return a=a.toLowerCase(),e[a]?b?e[a].hasListener(b,c):!0:!1;for(a in e)if(e[a].hasListener())return!0;return!1},hasEvent:function(a){return!!this.events[a]},removeAllListeners:function(a){var b=this.events;if(a)b[a]&&b[a].removeAllListeners();else for(a in b)b[a].removeAllListeners()},trigger:function(){var a=arguments[0],b=this.events,c=null;a=a.toLowerCase();if(b[a]){var e=b[a];c=e.trigger.apply(e,Y.call(arguments,1))}(e=b["*"])&&e.trigger.apply(e,arguments);return c},
suspendEvent:function(a){a=a.toLowerCase();var b=this.events;b[a]&&b[a].suspend()},suspendAllEvents:function(){var a=this.events,b;for(b in a)a[b].suspend()},resumeEvent:function(a){a=a.toLowerCase();var b=this.events;b[a]&&b[a].resume()},resumeAllEvents:function(){var a=this.events,b;for(b in a)a[b].resume()},destroyEvent:function(a){var b=this.events;b[a]&&(b[a].removeAllListeners(),b[a].destroy(),delete b[a])},destroy:function(){var a=this.events,b;for(b in a)this.destroyEvent(b);for(b in this)this[b]=
null},getApi:function(){if(!this.api){for(var a="createEvent getEvent on un once hasListener removeAllListeners trigger suspendEvent suspendAllEvents resumeEvent resumeAllEvents destroyEvent relayEvent unrelayEvent".split(" "),b={},c,e=-1,g=a.length;++e<g;c=a[e],b[c]=m(this[c],this));this.api=b}return this.api}},!0,!1);var Ja=function(){function a(b,g,h){var d;if(V(g)){var f=0;for(d=g.length;f<d;f++){var e=g[f];c.test(b)?h(b,e):a(b+"["+("object"===typeof e?f:"")+"]",e,h)}}else if(fa(g))for(f in g)a(b+
"["+f+"]",g[f],h);else h(b,g)}var b=/%20/g,c=/\[\]$/;return function(c){var e,h=[],d=function(a,d){d=u(d)?d():null==d?"":d;h[h.length]=encodeURIComponent(a)+"="+encodeURIComponent(d)};for(e in c)a(e,c[e],d);return h.join("&").replace(b,"+")}}();Z.register("mixin.Promise",{$$promise:null,$beforeInit:function(){this.$$promise=new da},then:function(){return this.$$promise.then.apply(this.$$promise,arguments)},done:function(){this.$$promise.done.apply(this.$$promise,arguments);return this},always:function(){this.$$promise.always.apply(this.$$promise,
arguments);return this},fail:function(){this.$$promise.fail.apply(this.$$promise,arguments);return this}});(function(){var a={xml:"application/xml, text/xml",html:"text/html",script:"text/javascript, application/javascript",json:"application/json, text/javascript",text:"text/plain",_default:"*/*"};return N({$class:"ajax.transport.XHR",type:"xhr",_xhr:null,_deferred:null,_ajax:null,$init:function(a,c,e){var b;window.XMLHttpRequest&&(b=new XMLHttpRequest)||(b=new ActiveXObject("Msxml2.XMLHTTP"));this._xhr=
b;this._deferred=c;this._opt=a;this._ajax=e;a.progress&&(b.onprogress=m(a.progress,a.context));a.uploadProgress&&b.upload&&(b.upload.onprogress=m(a.uploadProgress,a.context));b.onreadystatechange=m(this.onReadyStateChange,this)},setHeaders:function(){var b=this._opt,c=this._xhr,e;if(b.xhrFields)for(e in b.xhrFields)c[e]=b.xhrFields[e];b.data&&b.contentType&&c.setRequestHeader("Content-Type",b.contentType);c.setRequestHeader("X-Requested-With","XMLHttpRequest");c.setRequestHeader("Accept",b.dataType&&
a[b.dataType]?a[b.dataType]+", */*; q=0.01":a._default);for(e in b.headers)c.setRequestHeader(e,b.headers[e])},onReadyStateChange:function(){var a=this._xhr,c=this._deferred;if(0===a.readyState)a.onreadystatechange=C,c.resolve(a);else if(4===a.readyState){a.onreadystatechange=C;a:{try{var e=!a.status&&location&&"file:"==location.protocol||200<=a.status&&300>a.status||304===a.status||1223===a.status;break a}catch(g){}e=!1}if(e)this._ajax.processResponse(r(a.responseText)?a.responseText:void 0,a.getResponseHeader("content-type")||
"");else{a.responseData=null;try{a.responseData=this._ajax.returnResponse(r(a.responseText)?a.responseText:void 0,a.getResponseHeader("content-type")||"")}catch(g){}c.reject(a)}}},abort:function(){this._xhr.onreadystatechange=C;this._xhr.abort()},send:function(){var a=this._opt;try{this._xhr.open(a.method,a.url,!0,a.username,a.password),this.setHeaders(),this._xhr.send(a.data)}catch(c){this._deferred&&this._deferred.reject(c)}}})})();N({$class:"ajax.transport.Script",type:"script",_opt:null,_deferred:null,
_ajax:null,_el:null,$init:function(a,b,c){this._opt=a;this._ajax=c;this._deferred=b},send:function(){var a=document.createElement("script");a.setAttribute("async","async");a.setAttribute("charset","utf-8");a.setAttribute("src",this._opt.url);L(a,"load",m(this.onLoad,this));L(a,"error",m(this.onError,this));document.head.appendChild(a);this._el=a},onLoad:function(a){this._deferred&&this._deferred.resolve(a)},onError:function(a){this._deferred.reject(a)},abort:function(){this._el.parentNode&&this._el.parentNode.removeChild(this._el)},
destroy:function(){this._el.parentNode&&this._el.parentNode.removeChild(this._el)}});N({$class:"ajax.transport.IFrame",type:"iframe",_opt:null,_deferred:null,_ajax:null,_el:null,_sent:!1,$init:function(a,b,c){this._opt=a;this._ajax=c;this._deferred=b},send:function(){var a=this,b=document.createElement("iframe"),c="frame-"+ja(),e=a._opt.form;b.setAttribute("id",c);b.setAttribute("name",c);b.style.display="none";document.body.appendChild(b);e.setAttribute("action",a._opt.url);e.setAttribute("target",
c);L(b,"load",m(a.onLoad,a));L(b,"error",m(a.onError,a));a._el=b;var g=0,h=function(){g++;try{e.submit(),a._sent=!0}catch(d){2<g?a._deferred.reject(d):I(h,null,[],1E3)}};h()},onLoad:function(){var a=this._el;if(this._sent&&this._opt&&!this._opt.jsonp)try{var b=a.contentDocument||a.contentWindow.document;var c=b.body.innerHTML;this._ajax.processResponse(c)}catch(e){this._deferred.reject(e)}},onError:function(a){this._sent&&this._deferred.reject(a)},abort:function(){this._el.parentNode&&this._el.parentNode.removeChild(this._el)},
destroy:function(){this._el.parentNode&&this._el.parentNode.removeChild(this._el)}});(function(){var a=/\?/,b=/^([\w.+-]+:)(?:\/\/(?:[^\/?#]*@|)([^\/?#:]*)(?::(\d+)|)|)/,c=/#.*$/,e=/([?&])_=[^&]*/,g=new Ba,h=!(!window||!window.FormData),d=function(a,d,b){var c=d?d.dataType:null;d=d?d.selector:null;if(!r(a))return a;b=b||"";if("xml"===c||!c&&0<=b.indexOf("xml"))return a=Ea(Ia(a)),d?J(d,a):a;if("html"===c)return a=Ea(a,"text/html"),d?J(d,a):a;if("fragment"==c){b=document.createDocumentFragment();c=
document.createElement("div");for(c.innerHTML=a;c.firstChild;)b.appendChild(c.firstChild);return b}if("json"===c||!c&&0<=b.indexOf("json"))return Ra(Ia(a));("script"===c||!c&&0<=b.indexOf("javascript"))&&p(a);return a+""},f=function(a){return"/"==a.substr(0,1)?location.protocol+"//"+location.host+a:a},k=function(d,b){d.replace(c,"");if(!b.allowCache){var f=(new Date).getTime();d=e.test(d)?d.replace(e,"$1_="+f):d+(a.test(d)?"&":"?")+"_="+f}!b.data||"POST"==b.method||b.contentType||h&&b.data instanceof
window.FormData||(b.data=r(b.data)?b.data:Ja(b.data),d+=(a.test(d)?"&":"?")+b.data,b.data=null);return d},n=function(a,d,b){var c;if(!la(a)&&!u(a)&&b){var f=document.createElement("input");f.setAttribute("type","hidden");f.setAttribute("name",b);f.setAttribute("value",a);d.appendChild(f)}else if(V(a)&&b)for(f=0,c=a.length;f<c;f++)n(a[f],d,b+"["+f+"]");else if(la(a))for(f in a)a.hasOwnProperty(f)&&n(a[f],d,b?b+"["+f+"]":f)},l=function(a){for(var d,b,c={},f=0;f<a.elements.length;f++)if(d=a.elements[f],
null!==H(d,"name"))if(b="INPUT"===d.nodeName.toUpperCase()?H(d,"type").toUpperCase():"TEXT","FILE"===b)for(b=0;b<d.files.length;c[d.name]=d.files[b++].name);else if("RADIO"!==b&&"CHECKBOX"!==b||d.checked)c[d.name]=d.value;return Ja(c)},p=function(a){var d=eval;a&&(/^[^\S]*use strict/.test(a)?(d=document.createElement("script"),d.text=a,document.head.appendChild(d).parentNode.removeChild(d)):d(a))};N({$class:"Ajax",$mixins:["mixin.Promise"],_jsonpName:null,_transport:null,_opt:null,_deferred:null,
_promise:null,_timeout:null,_form:null,_removeForm:!1,$init:function(a){a.url&&(a.url=f(a.url));var d=b.exec((window?window.location.href:"").toLowerCase())||[],c=b.exec(a.url.toLowerCase());this._opt=a;!0!==a.crossDomain&&!0!==a.ignoreCrossDomain&&(a.crossDomain=!(!c||c[1]===d[1]&&c[2]===d[2]&&(c[3]||("http:"===c[1]?"80":"443"))===(d[3]||("http:"===d[1]?"80":"443"))));var e;a.files&&!h&&(a.transport="iframe");"iframe"!=a.transport||a.form?a.form&&(this._form=a.form,"POST"!=a.method||h||(a.transport=
"iframe")):(this.createForm(),a.form=this._form);if(a.form&&"iframe"!=a.transport&&"POST"==a.method)h?a.data=new FormData(a.form):(a.contentType="application/x-www-form-urlencoded",a.data=l(a.form));else if("json"==a.contentType)a.contentType=a.contentTypeHeader||"text/plain",a.data=r(a.data)?a.data:JSON.stringify(a.data);else if(fa(a.data)&&"POST"==a.method&&h)for(e in d=a.data,a.data=new FormData,d)a.data.append(e,d[e]);a.files&&this.importFiles();a.url=k(a.url,a);this._transport=e=!a.crossDomain&&
"script"!=a.transport||a.form?"iframe"==a.transport?new Q.ajax.transport.IFrame(a,this.$$promise,this):new Q.ajax.transport.XHR(a,this.$$promise,this):new Q.ajax.transport.Script(a,this.$$promise,this);this.$$promise.done(function(a){g.trigger("success",a)});this.$$promise.fail(function(a){g.trigger("error",a)});this.$$promise.always(function(){g.trigger("end")});g.trigger("start");a.timeout&&(this._timeout=setTimeout(m(this.onTimeout,this),a.timeout));a.jsonp&&this.createJsonp();!1===g.trigger("before-send",
a,e)&&this.$$promise.reject();a.beforeSend&&!1===a.beforeSend.call(a.context,a,e)&&this.$$promise.reject();this.$$promise.isPending()?(I(e.send,e),this.$$promise.always(this.asyncDestroy,this)):I(this.asyncDestroy,this,[],1E3)},asyncDestroy:function(){this.$isDestroyed()||(this.$$promise.hasListeners()?I(this.asyncDestroy,this,[],1E3):this.$destroy())},abort:function(a){this.$$promise.reject(a||"abort");this._transport.abort();return this},onTimeout:function(){this.abort("timeout")},getTransport:function(){return this._transport},
createForm:function(){var a=document.createElement("form");a.style.display="none";a.setAttribute("method",this._opt.method);a.setAttribute("enctype","multipart/form-data");n(this._opt.data,a,null);document.body.appendChild(a);this._form=a;this._removeForm=!0},importFiles:function(){var a=this._opt,d=a.files,b=this._form;a=a.data;var c,f;var e=0;for(c=d.length;e<c;e++){var k=d[e];if(V(k)){var g=k[0];k=k[1]}else g=window.File&&k instanceof File?k.uploadName||"upload"+(1<c?"[]":""):k.name||"upload"+
(1<c?"[]":"");if(!(window.File&&k instanceof File)){var h=k;k=null}if(b)h&&b.appendChild(h);else if(k)a.append(g,k);else if(h.files&&h.files.length)for(k=0,f=h.files.length;k<f;k++)a.append(g,h.files[k])}},createJsonp:function(){var d=this._opt,b=d.jsonpParam||"callback",c=d.jsonpCallback||"jsonp_"+ja();d.url+=(a.test(d.url)?"&":"?")+b+"="+c;this._jsonpName=c;"undefined"!=typeof window&&(window[c]=m(this.jsonpCallback,this));"undefined"!=typeof global&&(global[c]=m(this.jsonpCallback,this));return c},
jsonpCallback:function(a){try{var d=this.processResponseData(a)}catch(T){this.$$promise?this.$$promise.reject(T):aa(T)}this.$$promise&&this.$$promise.resolve(d)},processResponseData:function(a,b){var c=this._opt;a=d(a,c,b);g.hasListener("process-response")&&g.trigger("process-response",a,this.$$promise);c.processResponse&&(a=c.processResponse.call(c.context,a,this.$$promise));return a},returnResponse:function(a,d){return this._opt.jsonp?null:this.processResponseData(a,d)},processResponse:function(a,
d){var b=this.$$promise;if(this._opt.jsonp)if(a){try{p(a)}catch(E){b.reject(E)}b.isPending()&&b.reject("jsonp script didn't invoke callback")}else b.reject("jsonp script is empty");else{try{var c=this.processResponseData(a,d)}catch(E){b.reject(E)}b.resolve(c)}},destroy:function(){this._timeout&&clearTimeout(this._timeout);this._form&&this._form.parentNode&&this._removeForm&&this._form.parentNode.removeChild(this._form);this._transport.$destroy();this._jsonpName&&("undefined"!=typeof window&&delete window[this._jsonpName],
"undefined"!=typeof global&&delete global[this._jsonpName])}},{prepareUrl:k,global:g})})();var Sa=function(){var a={url:null,data:null,method:"GET",headers:null,username:null,password:null,cache:null,dataType:null,timeout:0,contentType:null,xhrFields:null,jsonp:!1,jsonpParam:null,jsonpCallback:null,transport:null,replace:!1,selector:null,form:null,beforeSend:null,progress:null,uploadProgress:null,processResponse:null,context:null},b={},c=function(c,g){g=g||{};c&&!r(c)?g=c:g.url=c;if(!g.url&&(g.form&&
(g.url=H(g.form,"action")),!g.url))throw"Must provide url";w(g,b,!1,!0);w(g,a,!1,!0);g.method=g.method?g.method.toUpperCase():g.form?H(g.form,"method").toUpperCase()||"GET":"GET";return new Q.Ajax(g)};c.setup=function(a){w(b,a,!0,!0)};c.on=function(){Q.Ajax.global.on.apply(Q.Ajax.global,arguments)};c.un=function(){Q.Ajax.global.un.apply(Q.Ajax.global,arguments)};c.get=function(a,b){b=b||{};b.method="GET";return c(a,b)};c.post=function(a,b){b=b||{};b.method="POST";return c(a,b)};c.load=function(a,
b,h){h=h||{};r(b)||(h=b);h.dataType="fragment";return c(b,h).done(function(d){if(h.replace)for(;a.firstChild;)a.removeChild(a.firstChild);a.appendChild(d)})};c.loadScript=function(a){return c(a,{transport:"script"})};c.submit=function(a,b){b=b||{};b.form=a;return c(null,b)};c.prepareUrl=function(a,b){return Q.Ajax.prepareUrl(a,b||{})};return c}(),ea=function(a,b,c){if(window.getComputedStyle){if(a===window)return b?c?0:null:{};a=getComputedStyle(a,null)}else a=a.currentStyle||a.style||{};b=b?a[b]:
a;return c?parseFloat(b)||0:b},Ta=function(){var a;return function(){if(void 0===a){var b=window.document,c=b.createElement("div"),e=b.createElement("div");b=b.body;e.style&&window.getComputedStyle?(c.style.cssText="border:0;width:0;height:0;top:0;left:-9999px;margin-top:1px;position:absolute",c.appendChild(e),e.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;display:block;margin-top:1%;top:1%;border:1px;padding:1px;width:4px;position:absolute",e.innerHTML=
"",b.appendChild(c),e="4px"===window.getComputedStyle(e,null).width,b.removeChild(c),a=e):a=!1}return a}}();O=function(a,b){var c=/^([+-]?(?:d*.|)d+(?:[eE][+-]?d+|))(?!px)[a-z%]+$/i,e=["Top","Right","Bottom","Left"],g=a?"inner"===a?"padding":"":"content";return function(a,d){if(a===window)return a.document.documentElement["client"+b];if(9===a.nodeType)return d=a.documentElement,Math.max(a.body["scroll"+b],d["scroll"+b],a.body["offset"+b],d["offset"+b],d["client"+b]);a:{var f=b.toLowerCase(),k=g||
(!0===d?"margin":"border");d=ea(a);var h=!0,l="width"===f?a.offsetWidth:a.offsetHeight,p="border-box"===d.boxSizing;if(0>=l||null==l){l=a.style[f];if(c.test(l)){d=l;break a}h=p&&(Ta()||l===a.style[f]);l=parseFloat(l)||0}a=l;k=k||(p?"border":"content");f=k===(h?"border":"content")?4:"width"===f?1:0;for(p=0;4>f;f+=2)"margin"===k&&(p+=parseFloat(d[k+e[f]])),h?("content"===k&&(p-=parseFloat(d["padding"+e[f]])),"margin"!==k&&(p-=parseFloat(d["border"+e[f]+"Width"]))):(p+=parseFloat(d["padding"+e[f]]),
"padding"!==k&&(p+=parseFloat(d["border"+e[f]+"Width"])));d=a+p}return d}};var sa=O("outer","Width"),ta=O("outer","Height"),pa={},Ua=function(){var a=/((^|[^a-z0-9_$\]\)'"])|(this))(\.)([^0-9])/ig,b=Function,c={},e=0,g={},h=0,d={},f=0,k=function(){1E3<=e&&(c={});1E3<=h&&(g={});1E3<=f&&(d={})};return{createGetter:function(d,f){try{if(!c[d]||f){e++;var k="".concat("try {","return ",d.replace(a,"$2____.$5"),";} catch (thrownError) { return undefined; }");return f?"function(____) {"+k+"}":c[d]=new b("____",
k)}return c[d]}catch(q){return aa(q),C}},createSetter:function(d,c){try{if(!g[d]||c){h++;var f=d.replace(a,"$2____.$5"),e="".concat("try {",f," = $$$$",";} catch (thrownError) { return undefined; }");return c?"function(____, $$$$) {"+e+"}":g[d]=new b("____","$$$$",e)}return g[d]}catch(x){return aa(x),C}},createFunc:function(c,e){try{if(!d[c]||e){f++;var k="".concat("try {",c.replace(a,"$2____.$5"),";} catch (thrownError) { return undefined; }");return e?"function(____) {"+k+"}":d[c]=new b("____",
k)}return d[c]}catch(q){return aa(q),C}},resetCache:k,enableResetCacheInterval:function(){setTimeout(k,1E4)}}}().createGetter;Z.register("mixin.Observable",{$$observable:null,$$callbackContext:null,$$events:null,$beforeInit:function(a){this.$$observable=new Ba;this.$initObservable(a)},$initObservable:function(a){var b=this.$$observable,c;if(a&&a.callback){var e=a.callback,g=e.context||e.scope||e.$context,h=w({},this.$$events,e.$events,!0,!1);for(c in h)b.createEvent(c,h[c]);e.context=null;e.scope=
null;for(c in e)if(e[c])b.on(c,e[c],g||this);a.callback=null;g&&(this.$$callbackContext=g)}else if(this.$$events)for(c in this.$$events)b.createEvent(c,this.$$events[c])},on:function(){var a=this.$$observable;return a?a.on.apply(a,arguments):null},un:function(){var a=this.$$observable;return a?a.un.apply(a,arguments):null},once:function(){var a=this.$$observable;return a?a.once.apply(a,arguments):null},trigger:function(){var a=this.$$observable;return a?a.trigger.apply(a,arguments):null},$beforeDestroy:function(){this.$$observable.trigger("before-destroy",
this)},$afterDestroy:function(){this.$$observable.trigger("destroy",this);this.$$observable.destroy();this.$$observable=null}});Z=function(a){var b=a?"pageYOffset":"pageXOffset",c=a?"scrollTop":"scrollLeft";a=window.document;var e=a.body,g=a.documentElement,h=function(a,d){return 0>a&&!1===d?0:a};var d=void 0!==window[b]?function(){return window[b]}:g.clientHeight?function(){return g[c]}:function(){return e[c]};return function(a,b){return a&&a!==window?a&&1==a.nodeType&&a!==e&&a!==g?h(a[c],b):h(d(),
b):h(d(),b)}};var wa=Z(!0),xa=Z(!1),Va=O("","Width"),Wa=O("","Height");N({$class:"dialog.position.Abstract",dialog:null,positionBase:null,correct:"solid",$init:function(a){this.dialog=a;w(this,a.getCfg().position,!0,!1);this.onWindowResizeDelegate=m(this.onWindowResize,this);this.onWindowScrollDelegate=m(this.onWindowScroll,this);var b=this.preferredType||this.type;if("string"==typeof b){var c=this.getAllPositions(),e;-1!=(e=c.indexOf(b))&&(c.splice(e,1),c.unshift(b));this.preferredType=c}else b||
(this.preferredType=this.getAllPositions());a.on("reposition",this.onReposition,this);a.on("show-after-delay",this.onShowAfterDelay,this);a.on("hide-after-delay",this.onHideAfterDelay,this);if(a.isVisible())this.onShowAfterDelay()},getPositionBase:function(){if(this.positionBase)return this.positionBase;var a;return(a=this.dialog.getCfg().position.base)?this.positionBase="string"==typeof a?J(a).shift():a:null},getBoundary:function(){var a=this.getPositionBase(),b=this.screenX||0,c=this.screenY||0;
if(a){var e=ca(a);var g=sa(a);a=ta(a);return{x:e.left+b,y:e.top+c,x1:e.left+g-b,y1:e.top+a-c,w:g,h:a}}g=Va(window);a=Wa(window);e=wa(window);var h=xa(window);return{x:h+b,y:e+c,x1:h+g-b,y1:e+a-c,w:g,h:a}},getPrimaryPosition:function(a){return!1},getSecondaryPosition:function(a){return!1},getAllPositions:function(){return[]},correctPosition:function(a){var b=this.getPrimaryPosition(),c=this.correct;if(b&&c){var e=this.dialog;b=this.getBoundary();e=e.getDialogSize();var g=this.preferredType,h=g[0];
if(c&&"solid"!=c){if(this.type!=h&&this.checkIfFits(a,h,b,e,!1))return this.changeType(h),this.fitToBoundary(this.getCoords(a),b,e);if(this.checkIfFits(a,this.type,b,e,!1))return this.fitToBoundary(this.getCoords(a),b,e)}if(c&&"position-only"!=c)for(c=0,h=g.length;c<h;c++)if(this.checkIfFits(a,g[c],b,e,!0)){this.changeType(g[c]);break}return this.getCoords(a)}},checkIfFits:function(a,b,c,e,g){a=this.getCoords(a,b,!0);if(!g&&this.getSecondaryPosition(b))return!1;if(g)return!(a.x<c.x||a.y<c.y||a.x+
e.width>c.x1||a.y+e.height>c.y1);switch(this.getPrimaryPosition(b)){case "t":return a.y>=c.y;case "r":return a.x+e.width<=c.x1;case "b":return a.y+e.height<=c.y1;case "l":return a.x>=c.x}},fitToBoundary:function(a,b,c){var e=this.getPositionBase(),g=e?0:b.x,h=e?0:b.y,d=e?b.w:b.x1;b=e?b.h:b.y1;var f=e=0,k=this.dialog.getPointer();a.x<g&&(e=a.x-g,a.x=g);a.y<h&&(f=a.y-h,a.y=h);a.x+c.width>d&&(e=a.x+c.width-d,a.x-=e);a.y+c.height>b&&(f=a.y+c.height-b,a.y-=f);k.setCorrectionOffset(e,f);k.reposition();
return a},changeType:function(a){var b=this.dialog.getPointer();this.type=a;b.setType(null,null)},onReposition:function(a,b){a=!1!==this.screenX||!1!==this.screenY?this.correctPosition(b):this.getCoords(b);this.apply(a)},getCoords:function(a){return{left:0,top:0}},apply:function(a){if(a&&!isNaN(a.x)&&!isNaN(a.y)){var b=this.dialog,c=b.getCfg().position.axis,e={};"y"!=c&&(e.left=a.x+"px");"x"!=c&&(e.top=a.y+"px");S(b.getElem(),e)}},onWindowResize:function(a){this.dialog.reposition(K(a))},onWindowScroll:function(a){this.dialog.reposition(K(a))},
onShowAfterDelay:function(){(this.resize||this.screenX||this.screenY)&&L(window,"resize",this.onWindowResizeDelegate);(this.scroll||this.screenX||this.screenY)&&L(this.dialog.getScrollEl(this.scroll),"scroll",this.onWindowScrollDelegate)},onHideAfterDelay:function(){(this.resize||this.screenX||this.screenY)&&P(window,"resize",this.onWindowResizeDelegate);(this.scroll||this.screenX||this.screenY)&&P(this.dialog.getScrollEl(this.scroll),"scroll",this.onWindowScrollDelegate)},destroy:function(){var a=
this.dialog;P(window,"resize",this.onWindowResizeDelegate);P(a.getScrollEl(this.scroll),"scroll",this.onWindowScrollDelegate);a.un("reposition",this.onReposition,this);a.un("show-after-delay",this.onShowAfterDelay,this);a.un("hide-after-delay",this.onHideAfterDelay,this);if(a.isVisible())this.onHideAfterDelay()}});var Na=function(){return function c(b){if(b===window)return!0;if(3==b.nodeType)return b.parentElement?c(b.parentElement):!0;var e=window.document.documentElement;return b===e?!0:e.contains(b)}}();
N({$class:"dialog.position.Target",$extends:"dialog.position.Abstract",getCoords:function(a,b,c){var e=this.dialog,g=e.getCfg(),h=e.getTarget();if(!h)return null;b=b||this.type;var d=this.getPositionBase();a=e.getDialogSize();if(d&&!c)a:{c={top:0,left:0};var f=window.document.documentElement;if(h===window||h===f)h=c;else{if("fixed"==ea(h,"position"))var k=h.getBoundingClientRect();else if(d){h=ca(h);c=ca(d);h={left:h.left-c.left,top:h.top-c.top};0>h.left&&(h.left=0);0>h.top&&(h.top=0);break a}else{d=
window.document.documentElement;for(k=h.offsetParent||d;k&&k!=d&&"static"==ea(k,"position");)k=k.offsetParent;d=k||d;k=ca(h);d!==f&&(c=ca(d));c.top+=ea(d,"borderTopWidth",!0);c.left+=ea(d,"borderLeftWidth",!0)}h={top:k.top-c.top-ea(h,"marginTop",!0),left:k.left-c.left-ea(h,"marginLeft",!0)}}}else h=ca(h);c=e.getTargetSize();f={};d=b.substr(0,1);k=b.substr(1);var n=g.position.offsetX;g=g.position.offsetY;b=e.pointer.getDialogPositionOffset(b);switch(d){case "t":f.y=h.top-a.height-g;break;case "r":f.x=
h.left+c.width+n;break;case "b":f.y=h.top+c.height+g;break;case "l":f.x=h.left-a.width-n}switch(k){case "t":f.y=h.top+g;break;case "r":f.x=h.left+c.width-a.width-n;break;case "b":f.y=h.top+c.height-a.height-g;break;case "l":f.x=h.left+n;break;case "rc":f.x=h.left+c.width+n;break;case "lc":f.x=h.left-a.width-n;break;case "":switch(d){case "t":case "b":f.x=h.left+c.width/2-a.width/2;break;case "r":case "l":f.y=h.top+c.height/2-a.height/2}}b&&(f.x+=b.x,f.y+=b.y);return f},getPrimaryPosition:function(a){return(a||
this.type).substr(0,1)},getSecondaryPosition:function(a){return(a||this.type).substr(1)},getAllPositions:function(){return"t r b l tl tr rt rb br bl lb lt tlc trc brc blc".split(" ")}});N({$class:"dialog.position.Mouse",$extends:"dialog.position.Target",correct:"position",$init:function(a){this.onMouseMoveDelegate=m(this.onMouseMove,this);this.$super(a)},getCoords:function(a,b,c){if(!a)return null;var e=b||this.type,g=this.dialog,h=g.getCfg(),d=g.getDialogSize(),f=this.getPositionBase(),k={};b=(b||
this.type).substr(1);var n=h.position.offsetX,l=h.position.offsetY;h=h.position.axis;e=g.getPointer().getDialogPositionOffset(e);var p=0,q=0;!c&&f&&(f=ca(f),p=f.left,q=f.top);switch(b){case "":k=this.get.call(g.$$callbackContext,g,a,b,c);break;case "c":k.y=a.pageY-q-d.height/2;k.x=a.pageX-p-d.width/2;break;case "t":k.y=a.pageY-q-d.height-l;k.x=a.pageX-p-d.width/2;break;case "r":k.y=a.pageY-q-d.height/2;k.x=a.pageX-p+n;break;case "b":k.y=a.pageY-q+l;k.x=a.pageX-p-d.width/2;break;case "l":k.y=a.pageY-
q-d.height/2;k.x=a.pageX-p-d.width-n;break;case "rt":k.y=a.pageY-q-d.height-l;k.x=a.pageX-p+n;break;case "rb":k.y=a.pageY-q+l;k.x=a.pageX-p+n;break;case "lt":k.y=a.pageY-q-d.height-l;k.x=a.pageX-p-d.width-n;break;case "lb":k.y=a.pageY-q+l,k.x=a.pageX-p-d.width-n}e&&(k.x+=e.x,k.y+=e.y);h&&(a=this.$super(a,b))&&("x"==h?k.y=a.y:k.x=a.x);return k},onShowAfterDelay:function(){this.$super();L(window.document.documentElement,"mousemove",this.onMouseMoveDelegate)},onHideAfterDelay:function(){this.$super();
P(window.document.documentElement,"mousemove",this.onMouseMoveDelegate)},onMouseMove:function(a){this.dialog.reposition(K(a))},getPrimaryPosition:function(a){return(a||this.type).substr(1,1)},getSecondaryPosition:function(a){return(a||this.type).substr(2)},getAllPositions:function(){return"mt mr mb ml mrt mrb mlb mlt".split(" ")}});N({$class:"dialog.position.Window",$extends:"dialog.position.Abstract",getCoords:function(a,b){var c=this.dialog;a=this.getPositionBase()||window;c=c.getDialogSize();var e=
{};b=(b||this.type).substr(1);var g=this.offsetX,h=this.offsetY,d=wa(a),f=xa(a),k=sa(a);a=ta(a);switch(b){case "c":e.y=a/2-c.height/2+d;e.x=k/2-c.width/2+f;break;case "t":e.y=d+h;e.x=k/2-c.width/2+f;break;case "r":e.y=a/2-c.height/2+d;e.x=k-c.width+f-g;break;case "b":e.y=a-c.height+d-h;e.x=k/2-c.width/2+f;break;case "l":e.y=a/2-c.height/2+d;e.x=f+g;break;case "rt":e.y=d+h;e.x=k-c.width+f-g;break;case "rb":e.y=a-c.height+d-h;e.x=k-c.width+f-g;break;case "lt":e.y=d+h;e.x=f+g;break;case "lb":e.y=a-c.height+
d-h,e.x=f+g}return e},getPrimaryPosition:function(a){return(a||this.type).substr(1,1)},getSecondaryPosition:function(a){return(a||this.type).substr(2)},getAllPositions:function(){return"wt wr wb wl wrt wrb wlb wlt wc".split(" ")},correctPosition:function(a){return this.getCoords(a)}});N({$class:"dialog.position.Custom",$extends:"dialog.position.Abstract",getCoords:function(a){var b=this.dialog;return this.get.call(b.$$callbackContext,b,a)}});N({$class:"dialog.pointer.Abstract",enabled:null,node:null,
correctX:0,correctY:0,$init:function(a,b){w(this,b,!0,!1);this.origCfg=b;this.dialog=a;this.opposite={t:"b",r:"l",b:"t",l:"r"};this.names={t:"top",r:"right",b:"bottom",l:"left"};this.sides={t:["l","r"],r:["t","b"],b:["r","l"],l:["b","t"]};this.enabled=!1!==this.enabled&&b.size?!0:!1},enable:function(){this.enabled||(this.enabled=!0,this.render(),this.dialog.isVisible()&&this.dialog.reposition())},disable:function(){this.enabled&&(this.remove(),this.enabled=!1,this.dialog.isVisible()&&this.dialog.reposition())},
getElem:function(){return this.node},getSize:function(){return this.enabled?this.size:0},setCorrectionOffset:function(a,b){this.correctX=a;this.correctY=b},getCorrectionValue:function(a,b,c){if(!b)return 0;var e=c.substr(0,1);c=c.substr(1,1);var g=this.dialog.getDialogSize(),h=this.width,d="t"==e||"b"==e?"width":"height";switch(c){case "":var f=g[d]/2-h/2;var k=-f;break;case "l":k=0;f=g[d]-h/2;break;case "r":k=-(g[d]-h/2),f=0}b=0>b?Math.max(k,b):Math.min(f,b);return("t"==e||"b"==e)&&"x"==a||("l"==
e||"r"==e)&&"y"==a?b:0},getDialogPositionOffset:function(a){var b=(this.detectPointerPosition(a)||"").substr(0,1);a=this.dialog.getPosition().getPrimaryPosition(a);var c={x:0,y:0};if(!this.enabled)return c;b==this.opposite[a]&&(c["t"==b||"b"==b?"y":"x"]="b"==b||"r"==b?-this.size:this.size);return c},detectPointerPosition:function(a){if(this.position&&!a)return u(this.position)?this.position.call(this.dialog.$$callbackContext,this.dialog,this.origCfg):this.position;var b=this.dialog.getPosition().getPrimaryPosition(a);
a=this.dialog.getPosition().getSecondaryPosition(a);var c=a.substr(1,1);if(!b)return null;b=this.opposite[b];a&&(a=a.substr(0,1),b="c"==c?b+this.opposite[a]:b+a);return b},detectPointerDirection:function(a){return this.direction?u(this.direction)?this.direction.call(this.dialog.$$callbackContext,this.dialog,a,this.origCfg):this.direction:a},update:function(){this.remove();this.render();this.append();this.dialog.isVisible()&&this.dialog.reposition()},setType:function(a,b){this.position=a;this.direction=
b;this.update();this.reposition()},render:function(){},destroy:function(){this.remove()},reposition:function(){},append:function(){if(this.enabled&&(this.node||this.render(),this.node)){this.reposition();var a=this.dialog.getElem();a&&a.appendChild(this.node)}},remove:function(){var a=this.node;a&&(a.parentNode&&a.parentNode.removeChild(a),this.node=null)}});(function(){var a=null,b={backgroundColor:"transparent",width:"0px",height:"0px",position:"absolute",fontSize:"0px",lineHeight:"0px"};return N({$class:"dialog.pointer.Html",
$extends:"dialog.pointer.Abstract",node:null,sub:null,$init:function(b,e){null===a&&(a=window.document.all&&!window.XMLHttpRequest);this.$super(b,e);this.width=this.width||2*this.size;this.inner&&(this.enabled=!0)},createInner:function(){var a=w({},this.origCfg);a.size=this.size-2*this.border;a.width=this.width-4*this.border;a.border=0;a.borderColor=null;a.borderCls=null;a.offset=0;a.inner=this.border;this.sub=ha("dialog.pointer.Html",this.dialog,a)},getBorders:function(b,e,g){var c={},d=b.substr(0,
1);b=e.substr(0,1);var f=e.substr(1);e=a?"dotted":"solid";var k=this.names,n=this.sides,l=this.opposite;c["border"+X(k[l[d]])]=this.size+"px solid "+g;c["border"+X(k[d])]="0 "+e+" transparent";f?(c["border"+X(k[f])]="0 solid transparent",c["border"+X(k[l[f]])]=this.width+"px "+e+" transparent"):(g=Math.floor(this.width/2),c["border"+X(k[n[b][0]])]=g+"px "+e+" transparent",c["border"+X(k[n[b][1]])]=g+"px "+e+" transparent");return c},getOffsets:function(a,b){var c={},e=this.names,d=this.opposite,f=
a.substr(0,1),k="t"==f||"b"==f?"r":"b";c[e[f]]=this.inner?"auto":-this.size+"px";c[e[k]]="auto";if(this.inner)a=b.substr(0,1),b=b.substr(1),c[e[d[k]]]=b?"l"==b||"t"==b?this.inner+"px":-this.width-this.inner+"px":Math.floor(-this.width/2)+"px",c[e[d[a]]]=-(this.size+2*this.inner)+"px";else{switch(a){case "t":case "r":case "b":case "l":b=b!=a?"l"==b||"t"==b?this.offset:-this.width+this.offset:-this.width/2+this.offset;break;case "bl":case "tl":case "lt":case "rt":b=this.offset;break;default:b=-this.width-
this.offset}c["margin"+X(e[d[k]])]=b+"px";switch(a){case "t":case "r":case "b":case "l":b="50%";break;case "tr":case "rb":case "br":case "lb":b="100%";break;default:b=0}c[e[d[k]]]=b;e=ra().transform;d="";k=this.correctX;b=this.correctY;e&&(k&&(d+=" translateX("+this.getCorrectionValue("x",k,a)+"px)"),b&&(d+=" translateY("+this.getCorrectionValue("y",b,a)+"px)"),c[e]=d)}return c},render:function(){if(this.enabled&&!this.node&&this.detectPointerPosition()){this.border&&!this.sub&&this.createInner();
this.node=window.document.createElement("div");var a=window.document.createComment(" ");this.node.appendChild(a);S(this.node,b);U(this.node,this.borderCls||this.cls);this.sub&&(this.sub.render(),this.node.appendChild(this.sub.getElem()))}},reposition:function(){var a=this.detectPointerPosition(),b=this.detectPointerDirection(a);this.node&&(S(this.node,this.getBorders(a,b,this.borderColor||this.color)),S(this.node,this.getOffsets(a,b)),this.sub&&this.sub.reposition())},update:function(){this.sub&&
(this.sub.$destroy(),this.sub=null);this.remove();this.node=null;this.render();this.append();this.dialog.isVisible()&&this.dialog.reposition()},destroy:function(){this.sub&&(this.sub.$destroy(),this.sub=null);this.$super()},remove:function(){this.sub&&this.sub.remove();this.$super()}})})();N({$class:"dialog.Overlay",dialog:null,enabled:!1,color:"#000",opacity:.5,cls:null,animateShow:!1,animateHide:!1,$mixins:["mixin.Observable"],$init:function(a){this.dialog=a;this.onClickDelegate=m(this.onClick,
this);w(this,a.getCfg().overlay,!0,!1);this.$$observable.createEvent("click",!1);this.enabled&&(this.enabled=!1,this.enable())},getElem:function(){this.enabled&&!this.node&&this.render();return this.node},enable:function(){this.enabled||(this.enabled=!0)},disable:function(){this.enabled&&(this.remove(),this.enabled=!1)},show:function(a){this.enabled&&(this.animateShow?this.animate("show",a):this.node.style.display="block")},hide:function(a){this.node&&(this.animateHide?this.animate("hide",a):this.node.style.display=
"none")},render:function(){if(this.enabled){var a=window.document.createElement("div"),b=this.dialog.getCfg();S(a,{display:"none",position:"fixed",left:0,top:0,right:0,bottom:0,opacity:this.opacity,backgroundColor:this.color});L(a,"click",this.onClickDelegate);b.render.zIndex&&S(a,"zIndex",b.render.zIndex);this.cls&&U(a,this.cls);this.node=a}},remove:function(){var a=this.node;a&&G(function(){a.parentNode&&a.parentNode.removeChild(a)})},append:function(){var a=this.dialog.getCfg().render.appendTo||
window.document.body;this.enabled&&(this.node||this.render(),a.appendChild(this.node))},animate:function(a,b){var c=this.node;var e="show"==a?this.animateShow:this.animateHide;u(e)&&(e=e(this,b));ma(e)?e=a:r(e)&&(e=[e]);return Ha(c,e,function(){if("show"==a){var b=new da;G(function(){c.style.display="";b.resolve()});return b}},!1)},onClick:function(a){return!1===this.trigger("click",this.dialog,this,a)?null:this.modal?(a=K(a),a.preventDefault(),a.stopPropagation(),!1):null},destroy:function(){this.remove()}});
N({$class:"dialog.Manager",all:null,groups:null,$init:function(){this.all={};this.groups={}},register:function(a){var b=a.getInstanceId(),c=a.getGroup(),e=this.groups,g;this.all[b]=a;var h=0;for(g=c.length;h<g;h++){var d=c[h];e[d]||(e[d]={});e[d][b]=!0}a.on("destroy",this.unregister,this)},unregister:function(a){a=a.getInstanceId();delete this.all[a]},hideAll:function(a){var b=a.getInstanceId();a=a.getGroup();var c=this.all,e=this.groups,g,h;var d=0;for(g=a.length;d<g;d++){var f=a[d];f=e[f];for(h in f)c[h]?
h==b||c[h].isHideAllIgnored()||c[h].hide(null,!0,!0):delete f[h]}}});Z=function(){var a=ha("dialog.Manager"),b=function(a,b,c,e){if("show"===c||!e)return b.preventDefault(),b.stopPropagation(),!1},c=function(a,b,c,e){var d=a[b],f=!1;if(void 0!==d){switch(e){case "string":f=r(d);break;case "function":f=u(d);break;case "number":f=1===ka(d)||d==parseInt(d);break;case "dom":f=d&&(d.tagName||d.nodeName)?!0:!1;break;case "jquery":(f=d&&d.jquery?!0:!1)&&(d=d.get(0));break;case "boolean":if(!0===d||!1===
d)f=!0;break;default:!0===e&&!0===d&&(f=!0),!1===e&&!1===d&&(f=!0)}f&&(a[b]={},a[b][c]=d)}},e=function(a){if(!a)return{};c(a,"content","value","string");c(a,"content","value","boolean");c(a,"content","fn","function");c(a,"ajax","url","string");c(a,"cls","dialog","string");c(a,"render","tpl","string");c(a,"render","fn","function");c(a,"render","el","dom");c(a,"render","el","jquery");c(a,"show","events",!1);c(a,"show","events","string");c(a,"hide","events",!1);c(a,"hide","events","string");c(a,"toggle",
"events",!1);c(a,"toggle","events","string");c(a,"position","type","string");c(a,"position","type",!1);c(a,"position","get","function");c(a,"overlay","enabled","boolean");c(a,"pointer","position","string");c(a,"pointer","size","number");return a},g={target:null,group:null,modal:!1,useHref:!1,content:{value:"",fn:null,prepare:null,attr:null},ajax:{url:null,data:null,dataType:"text",method:"GET"},cls:{dialog:null,visible:null,hidden:null,loading:null},selector:{content:null},buttons:null,render:{tpl:"<div></div>",
fn:null,el:null,zIndex:null,lazy:!0,style:null,appendTo:null,id:null,keepVisible:!1,keepInDOM:!1,lifetime:null},events:{show:{"*":{process:b}},hide:{"*":{process:b}}},show:{delay:null,single:!1,events:null,animate:!1,ignoreHideAll:!1,focus:!1,preventScroll:!1,display:"block"},hide:{delay:null,timeout:null,events:null,destroy:!1,remove:!1,animate:!1,cancelShowDelay:!0},toggle:{events:null},position:{type:"t",preferredType:null,offsetX:0,offsetY:0,axis:null,get:null,screenX:!1,screenY:!1,base:null,
scroll:!1,resize:!0},pointer:{position:null,direction:null,size:0,width:null,color:null,offset:0,border:0,borderColor:null,el:null,cls:null,borderCls:null},overlay:{enabled:!1,color:"#000",opacity:.5,cls:null,animateShow:!1,animateHide:!1},callback:{context:null,"content-change":null,"before-show":null,show:null,"before-hide":null,hide:null,render:null,lifetime:null,"target-change":null,button:null}},h=N({$class:"Dialog",$mixins:["mixin.Observable"],id:null,node:null,overlay:null,pointer:null,cfg:null,
position:null,target:null,dynamicTarget:!1,dynamicTargetEl:null,visible:!1,enabled:!0,frozen:!1,rendered:!1,bindSelfOnRender:!1,hideTimeout:null,hideDelay:null,showDelay:null,destroyDelay:null,images:0,positionGetType:null,positionClass:null,positionAttempt:0,$constructor:function(){this.$$events={"before-show":{returnResult:!1},"before-hide":{returnResult:!1}};this.$super.apply(this,arguments)},$init:function(b){b=b||{};var d=b.preset;b.preset=null;this.cfg=b=w({},g,e(h.defaults),e(h[d]),e(b),!0,
!0);this.id=ja();this.onPreventScrollDelegate=m(this.onPreventScroll,this);this.onButtonClickDelegate=m(this.onButtonClick,this);this.onButtonKeyupDelegate=m(this.onButtonKeyup,this);this.showDelegate=m(this.show,this);this.hideDelegate=m(this.hide,this);this.toggleDelegate=m(this.toggle,this);this.onImageLoadDelegate=m(this.onImageLoad,this);a.register(this);b.modal&&(b.overlay.enabled=!0);this.overlay=ha("dialog.Overlay",this);d=X(b.pointer.$class||"Html");this.pointer=ha("dialog.pointer."+d,this,
b.pointer);u(b.position.type)&&(this.positionGetType=b.position.type);this.setTarget(b.target);b.target&&b.useHref&&(d=H(this.getTarget(),"href"),"#"===d.substr(0,1)?b.render.el=d:b.ajax.url=d);b.render.lazy||this.render();this.trigger("init",this);this.setHandlers("bind")},getElem:function(){return this.node},getInstanceId:function(){return this.id},getCfg:function(){return this.cfg},getPointer:function(){return this.pointer},getOverlay:function(){return this.overlay},isEnabled:function(){return this.enabled},
isVisible:function(){return this.visible},isHideAllIgnored:function(){return this.cfg.show.ignoreHideAll},isFrozen:function(){return this.frozen},isRendered:function(){return this.rendered},enable:function(){this.enabled=!0},disable:function(){this.hide();this.enabled=!1},freeze:function(){this.frozen=!0},unfreeze:function(){this.frozen=!1},getGroup:function(){var a=this.cfg;return a.group?r(a.group)?[a.group]:a.group:[""]},toggle:function(a,b){return a&&a.stopPropagation&&this.dynamicTarget&&this.visible&&
this.isDynamicTargetChanged(a)?this.show(a):this[this.visible?"hide":"show"](a,b)},resetHandlers:function(a,b){this.setHandlers("unbind");this.bindSelfOnRender=!1;a&&a.call(b,this,this.getCfg());this.setHandlers("bind")},setHandlers:function(a,b){var d=this.cfg,c=["show","hide","toggle"],f="bind"===a?L:P;a="bind"===a?La:Ma;for(var e,g,h,m,u,w,z,t,D,C;e=c.shift();)if(g=d[e].events,!1!==g){if(r(g)||V(g))this.dynamicTarget?(u={},u[g]=d.target,g={_html:u}):g={_target:g};for(h in g){if(b)if("_self"===
b){if("_self"!==h&&"_overlay"!==h&&">"!==h.substr(0,1))continue}else if(h!==b)continue;if("_self"!==h&&"_overlay"!==h&&">"!==h.substr(0,1)||this.node){if(z=g[h]){switch(h){case "_target":t=[this.getTarget()];break;case "_self":t=[this.node];break;case "_window":t=[window];break;case "_document":t=[window.document];break;case "_html":t=[window.document.documentElement];break;case "_overlay":t=[this.overlay.getElem()];break;default:t=">"===h.substr(0,1)?J(h.substr(1),this.node):J(h)}if(t&&t.length)if(r(z)&&
(z=[z]),V(z))for(u=0,w=z.length;u<w;u++)for(D=-1,C=t.length;++D<C;f(t[D],z[u],this[e+"Delegate"]));else for(m in z)for(D=-1,C=t.length;++D<C;a(t[D],z[m],m,this[e+"Delegate"]));}}else this.bindSelfOnRender=!0}}},onPreventScroll:function(a){K(a).preventDefault()},onButtonClick:function(a){var b=K(a).target;(b=M(b,"metaphorjsTooltip-button-id"))&&this.trigger("button",this,b,a)},onButtonKeyup:function(a){if(13===a.keyCode||32===a.keyCode){var b=M(a.target,"metaphorjsTooltip-button-id");b&&this.trigger("button",
this,b,K(a))}},getEventConfig:function(a,b){var d=this.node;for(var c=a.type,f=a.target,e=null,g;f&&f!==d;){if(g=H(f,"data-"+b+"-"+c)){e=Ua(g)({});break}f=f.parentNode}d=e;c=this.cfg;!d&&c.events[b]&&(d=c.events[b][a.type]||c.events[b]["*"]);return d},show:function(b,c){var d=this.cfg,f=null,e=d.show,g=null;b&&(b=K(b));this.isEnabled()||(g="disabled");!g&&this.visible&&this.hideTimeout&&(window.clearTimeout(this.hideTimeout),this.hideTimeout=I(this.hide,this,null,d.hide.timeout),g="hidetimeout");
!g&&this.hideDelay&&(window.clearTimeout(this.hideDelay),this.hideDelay=null,this.visible=!0,g="hidedelay");!g&&this.frozen&&(g="frozen");this.destroyDelay&&(window.clearTimeout(this.destroyDelay),this.destroyDelay=null);d=!1;b&&this.dynamicTarget&&(d=this.changeDynamicTarget(b));this.visible&&(d?(this.reposition(b),g="reposition"):g=g||"visible");if(!g||d)this.node?d&&this.changeDynamicContent():this.render();g||!1!==this.trigger("before-show",this,b)||(g="beforeshow");var h;b&&(h=this.getEventConfig(b,
"show"))&&(h.process?f=h.process(this,b,"show",g):(h.stopPropagation&&b.stopPropagation(),h.preventDefault&&b.preventDefault(),f=h.returnValue));if(g)return f;za(this.node);this.visible=!0;e.single&&a.hideAll(this);this.toggleTitleAttribute(!1);e.delay&&!c?this.showDelay=I(this.showAfterDelay,this,[b],e.delay):this.showAfterDelay(b,c);return f},showAfterDelay:function(a,b){var d=this,c=d.cfg;d.showDelay=null;if(d.visible){d.trigger("show-after-delay",d,a);c.hide.remove&&d.appendElem();d.reposition(a);
if(c.show.preventScroll){var f=c.show.preventScroll,e;!0===f&&(f="body");f=J(f);var g=-1;for(e=f.length;++g<e;L(f[g],"mousewheel",d.onPreventScrollDelegate)&&L(f[g],"touchmove",d.onPreventScrollDelegate));}d.overlay.show();c.show.animate&&!b?d.animate("show").done(function(){d.showAfterAnimation(a)}):G(function(){d.showAfterAnimation(a)})}},showAfterAnimation:function(a){var b=this.cfg,d=this.node;this.visible&&(ba(d,b.cls.hidden),U(d,b.cls.visible),b.render.keepVisible||(d.style.display=b.show.display||
"block"),b.hide.timeout&&(this.hideTimeout=I(this.hide,this,null,b.hide.timeout)),b.show.focus&&I(this.setFocus,this,null,20),this.trigger("show",this,a))},hide:function(a,b,c){var d=null,f=null,e=this.cfg;this.hideTimeout=null;!this.visible&&this.hideDelay&&b&&(window.clearTimeout(this.hideDelay),this.hideDelay=null,this.visible=!0);this.node&&this.visible&&this.isEnabled()||(f=this.node?this.visible?"disabled":"hidden":"noelem");this.showDelay&&!f&&(e.hide.cancelShowDelay||c?(window.clearTimeout(this.showDelay),
this.showDelay=null,this.visible=!1,f="cancel"):f="delay");this.frozen&&!f&&(f="frozen");f||!1!==this.trigger("before-hide",this,a)||(f="beforehide");var g;a&&a.stopPropagation&&(g=this.getEventConfig(a,"hide"))&&(g.process?d=g.process(this,a,"hide",f):(g.stopPropagation&&a.stopPropagation(),g.preventDefault&&a.preventDefault(),d=g.returnValue));if(f)return d;za(this.node);this.visible=!1;this.toggleTitleAttribute(!0);this.dynamicTarget&&this.resetDynamicTarget();e.hide.delay&&!b?this.hideDelay=I(this.hideAfterDelay,
this,[a],e.hide.delay):this.hideAfterDelay(a,b);return d},hideAfterDelay:function(a,b){var d=this,c=d.cfg;d.hideDelay=null;if(!d.visible){d.trigger("hide-after-delay",d,a);if(c.show.preventScroll){var f=c.show.preventScroll,e;!0===f&&(f="body");f=J(f);var g=-1;for(e=f.length;++g<e;P(f[g],"mousewheel",d.onPreventScrollDelegate)&&P(f[g],"touchmove",d.onPreventScrollDelegate));}d.overlay.hide();c.hide.animate&&!b?d.animate("hide").done(function(){d.hideAfterAnimation(a)}):G(function(){d.hideAfterAnimation(a)})}},
hideAfterAnimation:function(a){var b=this,d=b.cfg,c=b.node;b.visible||(ba(c,d.cls.visible),U(c,d.cls.hidden),d.render.keepVisible||(c.style.display="none"),b.trigger("hide",b,a),a=d.render.lifetime,null!==a&&(0===a?b.destroyElem():b.destroyDelay=I(b.destroyElem,b,null,a)),c&&d.hide.destroy?G(function(){M(c,d.instanceName,null);b.$destroy()}):c&&d.hide.remove&&G(function(){b.removeElem()}))},render:function(){var a=this.cfg;if(!this.node){var b=a.render,c=a.cls;if(b.fn){var e=b.fn.call(this.$$callbackContext,
this);b[r(e)?"tpl":"el"]=e}b.el?r(b.el)?(e=J(b.el).shift(),b.keepInDOM=!0):e=b.el:(e=window.document.createElement("div"),e.innerHTML=b.tpl,e=e.firstChild);e||(e=window.document.createElement("div"));this.node=e;b.id&&e.setAttribute("id",b.id);a.render.keepVisible||(e.style.display="none");U(e,c.dialog);U(e,c.hidden);b.style&&S(e,b.style);this.overlay.render();a.hide.remove?e.parentNode&&e.parentNode.removeChild(e):this.appendElem();b.zIndex&&S(e,{zIndex:b.zIndex});b=a.content;if(!1!==b.value)if(b.value)this.setContent(b.value);
else if(b.fn)this.setContent(b.fn.call(this.$$callbackContext,this));else this[a.ajax.url?"loadContent":"readContent"]();this.pointer.render();this.pointer.append();if(a.buttons)for(var g in a.buttons)if(b=J(a.buttons[g],e).shift())M(b,"metaphorjsTooltip-button-id",g),L(b,"click",this.onButtonClickDelegate),L(b,"keyup",this.onButtonKeyupDelegate);this.bindSelfOnRender&&(this.setHandlers("bind","_self"),this.bindSelfOnRender=!1);this.rendered=!0;this.trigger("render",this)}},setPositionType:function(a){var b=
this.getPositionClass(a);this.cfg.position.type=a;this.positionClass===b&&this.position?this.position.type=a:(this.position&&(this.position.$destroy(),this.position=null),b&&(this.position=ha(b,this)));this.isVisible()&&this.reposition()},getPosition:function(a){var b=this.cfg.position;if(!this.position){!this.positionGetType&&"custom"!==b.type&&u(b.get)&&"m"!==b.type&&(b.type="custom");a=this.positionGetType?this.positionGetType.call(this.$$callbackContext,this,a):b.type;var d=this.getPositionClass(a);
b.type=a;if(!1===d)return;this.positionClass!==d?this.position=ha(this.getPositionClass(a),this):this.position.type=a}return this.position},getPositionClass:function(a){return a?u(a)||"custom"===a?"dialog.position.Custom":(a=a.substr(0,1))?"w"===a?"dialog.position.Window":"m"===a?"dialog.position.Mouse":"dialog.position.Target":!1:!1},reposition:function(a){this.repositioning||(this.repositioning=!0,a&&(a=K(a)),this.getPosition(a),this.trigger("before-reposition",this,a),this.getPosition(a),this.trigger("reposition",
this,a),this.repositioning=!1)},getTarget:function(){return this.dynamicTarget?this.dynamicTargetEl:this.target},setTarget:function(a){if(a){var b=!1,d=this.target;this.target?(this.setHandlers("unbind","_target"),b=!0):this.dynamicTarget&&(b=!0);var c=r(a);c&&"#"!==a.substr(0,1)?(this.dynamicTarget=!0,this.target=null):(c&&(a=J(a).shift()),this.dynamicTarget=!1,this.target=a);b&&(this.setHandlers("bind","_target"),this.trigger("target-change",this,a,d))}},resetDynamicTarget:function(){var a=this.dynamicTargetEl;
a&&(this.setHandlers("unbind","_target"),this.trigger("target-change",this,null,a))},isDynamicTargetChanged:function(a){var b=this.cfg.target;a=a.target;for(var d=this.dynamicTargetEl;a&&!va(a,b);)a=a.parentNode;return a?!d||d!==a:!1},changeDynamicTarget:function(a){var b=this.cfg.target;a=a.target;for(var d=this.dynamicTargetEl;a&&!va(a,b);)a=a.parentNode;if(!a||d&&d===a)return!1;d&&this.setHandlers("unbind","_target");this.dynamicTargetEl=a;this.setHandlers("bind","_target");this.trigger("target-change",
this,a,d);return!0},getContentElem:function(){var a=this.node;return a?this.cfg.selector.content?J(this.cfg.selector.content,a).shift()||a:a:null},setContent:function(a,b){b=b||"";var d=this.node,c=this.cfg,e=this.pointer;if(!d)return c.content.value=a,this;c.content.prepare&&(a=c.content.prepare.call(this.$$callbackContext,this,b,a));var f=this.getContentElem(),g=this.rendered&&!c.selector.content&&e;e=g&&e.getElem();if(g&&e)try{d.removeChild(e)}catch(qa){}if(r(a))f.innerHTML=a;else for(var h in a){var m=
c.selector[h];m&&(m=J(m,f).shift())&&(m.innerHTML=a[h])}if(g&&e)try{d.appendChild(e)}catch(qa){}d=J("img",f);this.images=d.length;h=-1;for(c=d.length;++h<c;L(d[h],"load",this.onImageLoadDelegate));this.trigger("content-change",this,a,b);this.onContentChange()},readContent:function(){var a=this.cfg,b=this.getTarget(),c;b&&(c=a.content.attr?H(b,a.content.attr):H(b,"tooltip")||H(b,"title")||H(b,"alt"));c&&this.setContent(c,"attribute")},loadContent:function(a){var b=this.cfg;U(this.node,b.cls.loading);
a=w({},b.ajax,a,!0,!0);this.trigger("before-ajax",this,a);return Sa(a).done(this.onAjaxLoad,this)},onAjaxLoad:function(a){ba(this.node,this.cfg.cls.loading);this.setContent(a,"ajax")},onImageLoad:function(){this.images--;this.onContentChange()},onContentChange:function(){this.visible&&this.reposition()},changeDynamicContent:function(){var a=this.cfg;a.content.fn?this.setContent(a.content.fn.call(this.$$callbackContext,this)):a.content.attr&&this.readContent()},toggleTitleAttribute:function(a){var b=
this.getTarget(),d;b&&(!1===a?(M(b,"tmp-title",H(b,"title")),b.removeAttribute("title")):(d=M(b,"tmp-title"))&&b.setAttribute("title",d))},getDialogSize:function(){this.rendered||this.render();var a=this.cfg,b=this.node,c=a.cls.hidden?Ca(b,a.cls.hidden):!(b&&!(0>=b.offsetWidth||0>=b.offsetHeight)),e=b.style.left;c&&(S(b,{left:"-1000px"}),b.style.display=a.show.display);a={width:sa(b),height:ta(b)};c&&(S(b,{left:e}),b.style.display="none");return a},getTargetSize:function(){var a=this.getTarget();
return a?{width:sa(a),height:ta(a)}:null},setFocus:function(){var a=this.cfg,b=a.show.focus,c=this.node,e;if(!0===b)if(b=J("input",c).concat(J("textarea",c)),0<b.length)b[0].focus();else{if(a.buttons)for(e in a.buttons){(a=J(a.buttons[e],c).shift())&&a.focus();break}}else(a=J(b,c).shift())&&a.focus()},getScrollEl:function(a){return!0===a||!1===a?window:"string"===typeof a?J(a).shift():a},animate:function(a,b){var c=this.cfg,d=this.node;var e=c[a].animate;u(e)&&(e=e(this,b));var f=e.skipDisplayChange||
!1;ma(e)?e=a:r(e)&&(e=[e]);return Ha(d,e,function(){if("show"===a&&!f){var b=new da;G(function(){d.style.display=c.show.display||"block";b.resolve()});return b}},!1)},removeElem:function(){var a=this,b=a.node;a.overlay.remove();b&&b.parentNode&&G(function(){a.visible||b.parentNode.removeChild(b)})},appendElem:function(){var a=this.cfg,b=window.document.body;b=a.render.appendTo||b;this.overlay.append();this.node&&!1!==a.render.appendTo&&b.appendChild(this.node)},destroyElem:function(){var a=this.node;
this.setHandlers("unbind","_self");this.bindSelfOnRender=!0;this.pointer.remove();this.overlay.remove();a&&(this.cfg.render.keepInDOM||a.parentNode&&a.parentNode.removeChild(a),this.node=null);this.trigger("lifetime",this)},destroy:function(){this.setHandlers("unbind");this.trigger("destroy",this);this.destroyElem();this.overlay&&this.overlay.$destroy();this.pointer&&this.pointer.$destroy();this.position&&this.position.$destroy()}},{defaults:null});return h}();O={};O.Dialog=Z;O.onReady=function(a,
b){var c=!1,e=!0,g=b||window,h=function(b){if("readystatechange"!=b.type||"complete"==f.readyState)P("load"==b.type?g:f,b.type,h),!c&&(c=!0)&&a.call(g,b.type||b)},d=function(){try{k.doScroll("left")}catch(n){setTimeout(d,50);return}h("poll")};var f=g.document;var k=f.documentElement;if("complete"==f.readyState)a.call(g,"lazy");else{if(f.createEventObject&&k.doScroll){try{e=!g.frameElement}catch(n){}e&&d()}L(f,"DOMContentLoaded",h);L(f,"readystatechange",h);L(g,"load",h)}};"undefined"!=typeof global?
global.MetaphorJs=O:window.MetaphorJs=O})();
